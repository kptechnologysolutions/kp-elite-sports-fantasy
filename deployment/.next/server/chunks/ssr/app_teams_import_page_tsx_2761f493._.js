module.exports=[69188,a=>{"use strict";a.s(["default",()=>A],69188);var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(40695),f=a.i(3130),g=a.i(5522),h=a.i(17171),i=a.i(21958),j=a.i(73320),k=a.i(69922),l=a.i(96221),m=a.i(16201),n=a.i(92e3),o=(a.i(99745),a.i(18544)),p=(a.i(76644),a.i(33791)),q=(a.i(79715),a.i(42871));a.i(8361),p.Subscribable;var r=a.i(37927);c.createContext(function(){let a=!1;return{clearReset:()=>{a=!1},reset:()=>{a=!0},isReset:()=>a}}()),c.createContext(!1).Provider;var s=a.i(12794),t=p,u=class extends t.Subscribable{#a;#b=void 0;#c;#d;constructor(a,b){super(),this.#a=a,this.setOptions(b),this.bindMethods(),this.#e()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(a){let b=this.options;this.options=this.#a.defaultMutationOptions(a),(0,q.shallowEqualObjects)(this.options,b)||this.#a.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#c,observer:this}),b?.mutationKey&&this.options.mutationKey&&(0,q.hashKey)(b.mutationKey)!==(0,q.hashKey)(this.options.mutationKey)?this.reset():this.#c?.state.status==="pending"&&this.#c.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#c?.removeObserver(this)}onMutationUpdate(a){this.#e(),this.#f(a)}getCurrentResult(){return this.#b}reset(){this.#c?.removeObserver(this),this.#c=void 0,this.#e(),this.#f()}mutate(a,b){return this.#d=b,this.#c?.removeObserver(this),this.#c=this.#a.getMutationCache().build(this.#a,this.options),this.#c.addObserver(this),this.#c.execute(a)}#e(){let a=this.#c?.state??(0,s.getDefaultState)();this.#b={...a,isPending:"pending"===a.status,isSuccess:"success"===a.status,isError:"error"===a.status,isIdle:"idle"===a.status,mutate:this.mutate,reset:this.reset}}#f(a){o.notifyManager.batch(()=>{if(this.#d&&this.hasListeners()){let b=this.#b.variables,c=this.#b.context,d={client:this.#a,meta:this.options.meta,mutationKey:this.options.mutationKey};a?.type==="success"?(this.#d.onSuccess?.(a.data,b,c,d),this.#d.onSettled?.(a.data,null,b,c,d)):a?.type==="error"&&(this.#d.onError?.(a.error,b,c,d),this.#d.onSettled?.(void 0,a.error,b,c,d))}this.listeners.forEach(a=>{a(this.#b)})})}};let v=process.env.NEXT_PUBLIC_API_URL||"/api",w=new class{async fetchWithAuth(a,b={}){let c=await fetch(`${v}${a}`,{...b,headers:{"Content-Type":"application/json",...b.headers},credentials:"include"});if(!c.ok)throw Error(`API Error: ${c.statusText}`);return c.json()}async getTeams(){return this.fetchWithAuth("/teams")}async getTeam(a){return this.fetchWithAuth(`/teams/${a}`)}async importTeam(a,b){return this.fetchWithAuth("/teams/import",{method:"POST",body:JSON.stringify({platform:a,credentials:b})})}async updateTeam(a,b){return this.fetchWithAuth(`/teams/${a}`,{method:"PATCH",body:JSON.stringify(b)})}async getPlayer(a){return this.fetchWithAuth(`/players/${a}`)}async getPlayerNews(a){return this.fetchWithAuth(`/players/${a}/news`)}async getPlayerInsights(a){return this.fetchWithAuth(`/players/${a}/insights`)}async refreshPlayerData(a){return this.fetchWithAuth(`/players/${a}/refresh`,{method:"POST"})}async getLineupRecommendations(a,b){return this.fetchWithAuth(`/ai/lineup-recommendations?teamId=${a}&week=${b}`)}async analyzePlayer(a){return this.fetchWithAuth(`/ai/analyze-player/${a}`,{method:"POST"})}async searchNews(a){return this.fetchWithAuth(`/ai/search-news?q=${encodeURIComponent(a)}`)}subscribeToPlayerUpdates(a,b){let c=new WebSocket(`${process.env.NEXT_PUBLIC_WS_URL}/players/${a}`);return c.onmessage=a=>{b(JSON.parse(a.data))},()=>c.close()}subscribeToTeamUpdates(a,b){let c=new WebSocket(`${process.env.NEXT_PUBLIC_WS_URL}/teams/${a}`);return c.onmessage=a=>{b(JSON.parse(a.data))},()=>c.close()}},x=[{id:"espn",name:"ESPN",logo:"🏈",color:"bg-red-500"},{id:"yahoo",name:"Yahoo",logo:"🟣",color:"bg-purple-500"},{id:"sleeper",name:"Sleeper",logo:"😴",color:"bg-orange-500"},{id:"nfl",name:"NFL.com",logo:"🏆",color:"bg-blue-600"},{id:"cbs",name:"CBS Sports",logo:"📺",color:"bg-blue-500"}];function y({defaultPlatform:p}={}){let s=(0,d.useSearchParams)(),[t,v]=(0,c.useState)(p||""),[z,A]=(0,c.useState)("oauth"),[B,C]=(0,c.useState)({leagueId:"",teamId:""}),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)(""),[L,M]=(0,c.useState)([]),[N,O]=(0,c.useState)([]),[P,Q]=(0,c.useState)(!1),R=function(){let a=(0,r.useQueryClient)();return function(a,b){let d=(0,r.useQueryClient)(void 0),[e]=c.useState(()=>new u(d,a));c.useEffect(()=>{e.setOptions(a)},[e,a]);let f=c.useSyncExternalStore(c.useCallback(a=>e.subscribe(o.notifyManager.batchCalls(a)),[e]),()=>e.getCurrentResult(),()=>e.getCurrentResult()),g=c.useCallback((a,b)=>{e.mutate(a,b).catch(q.noop)},[e]);if(f.error&&(0,q.shouldThrowError)(e.options.throwOnError,[f.error]))throw f.error;return{...f,mutate:g,mutateAsync:f.mutate}}({mutationFn:({platform:a,credentials:b})=>w.importTeam(a,b),onSuccess:b=>{a.invalidateQueries({queryKey:["teams"]}),a.setQueryData(["teams",b.id],b)}})}();(0,c.useEffect)(()=>{"success"===s.get("import")&&s.get("platform")&&(G(!0),setTimeout(()=>G(!1),5e3))},[s]);let S=async()=>{if(!D)return void K("Please enter your Sleeper username");I(!0),K("");try{let{sleeperAPI:b}=await a.A(5030),c=await b.getUser(D);if(!c){K(`Username "${D}" not found on Sleeper`),I(!1);return}let d=await b.getUserLeagues(c.user_id);if(0===d.length){K("No leagues found for this user"),I(!1);return}M(d),O(d.map(a=>a.league_id)),I(!1)}catch(a){console.error("Error checking Sleeper username:",a),K("Failed to connect to Sleeper. Please try again."),I(!1)}},T=async()=>{if(0===N.length)return void K("Please select at least one league to import");I(!0),K("");try{let{enhancedSleeperAPI:b}=await a.A(78353),c=(await a.A(51104)).default,d=0;for(let a of N){if(!L.find(b=>b.league_id===a))continue;let e=await b.getCompleteTeamData(D,a);e&&(console.log("Enhanced Team Data:",{league:e.league.name,teamName:e.team.name,week:e.currentWeek,weekScore:e.matchup?.teamScore,opponent:e.matchup?.opponentName,players:e.players?.length}),c.importTeamFromAPI("sleeper",{leagueId:e.league.id,leagueName:e.league.name,teamName:e.team.name,players:e.players||[],record:{wins:e.record.wins,losses:e.record.losses,ties:e.record.ties,pointsFor:e.record.pointsFor,pointsAgainst:e.record.pointsAgainst,streak:`${e.record.wins>e.record.losses?"W":"L"}1`},matchup:e.matchup?{points:e.matchup.teamScore,opponentScore:e.matchup.opponentScore,opponentName:e.matchup.opponentName,week:e.matchup.week,starters:e.matchup.starters,startersPoints:e.matchup.startersPoints}:void 0,leagueSize:e.league.size,rank:e.record.rank||1,currentWeek:e.currentWeek})&&d++)}d>0?(G(!0),K(""),setTimeout(()=>{window.location.reload()},2e3)):K("No teams could be imported")}catch(a){console.error("Import failed:",a),K("Failed to import teams. Please try again.")}finally{I(!1)}},U=async()=>{if(t){if("sleeper"===t&&"oauth"===z)return void(L.length>0?await T():await S());I(!0),K("");try{let b=(await a.A(51104)).default;if("espn"===t){if("manual"===z&&B.leagueId){let{espnRealDataService:c}=await a.A(1094);if(B.teamId){let a=localStorage.getItem("espn_swid")||"";B.teamId&&a&&c.setCookies(B.teamId,a)}let d=await c.importLeague(B.leagueId);if(d.length>0){for(let a of d)b.addTeam(a);G(!0),setTimeout(()=>window.location.reload(),2e3)}else K("No teams found or unable to access league. Make sure the league is public or provide authentication.")}else K("Please enter your ESPN League ID");I(!1);return}if("yahoo"===t){if("oauth"===z){let a=process.env.NEXT_PUBLIC_YAHOO_CLIENT_ID;if(a&&"your_yahoo_client_id_here"!==a){let b=`${window.location.origin}/api/auth/yahoo/callback`,c=`https://api.login.yahoo.com/oauth2/request_auth?client_id=${a}&redirect_uri=${encodeURIComponent(b)}&response_type=code&scope=fspt-r&language=en-us`;localStorage.setItem("yahoo_import_initiated","true"),window.location.href=c}else{Q(!0),K(""),I(!1);return}}else"manual"===z&&B.leagueId?b.importTeam("yahoo",{leagueId:B.leagueId,teamId:B.teamId||`yahoo_team_${Date.now()}`,leagueName:"demo"===B.leagueId?"Yahoo Demo League":`Yahoo League ${B.leagueId}`})?(G(!0),K(""),setTimeout(()=>window.location.reload(),2e3)):K("Failed to import Yahoo team."):K("Please select an import method");I(!1);return}b.importTeam(t,{leagueId:`${t}_league_${Date.now()}`,teamId:`${t}_team_${Date.now()}`,leagueName:`${x.find(a=>a.id===t)?.name} League`}),G(!0),setTimeout(()=>{G(!1),window.location.reload()},2e3)}catch(a){console.error("Import failed:",a),K("Failed to import team. Please check your credentials and try again.")}finally{I(!1)}}};return(0,b.jsxs)("div",{className:"space-y-6",children:[F&&(0,b.jsx)(f.Card,{className:"border-green-500 bg-green-50 dark:bg-green-950",children:(0,b.jsxs)(f.CardContent,{className:"flex items-center space-x-2 pt-6",children:[(0,b.jsx)(m.CheckCircle,{className:"h-5 w-5 text-green-500"}),(0,b.jsxs)("p",{className:"text-green-700 dark:text-green-300",children:["Team successfully imported from ",s.get("platform")?.toUpperCase(),"!"]})]})}),(0,b.jsxs)(f.Card,{children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsx)(f.CardTitle,{children:"Import Your Fantasy Team"}),(0,b.jsx)(f.CardDescription,{children:"Connect your existing fantasy football team from any major platform"})]}),(0,b.jsxs)(f.CardContent,{children:[(0,b.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-6",children:x.map(a=>(0,b.jsxs)("button",{onClick:()=>{v(a.id)},className:`relative p-4 rounded-lg border-2 transition-all ${t===a.id?"border-primary bg-primary/5":"border-muted hover:border-muted-foreground/50"}`,children:[(0,b.jsx)("div",{className:"text-3xl mb-2",children:a.logo}),(0,b.jsx)("div",{className:"text-sm font-medium",children:a.name}),t===a.id&&(0,b.jsx)(m.CheckCircle,{className:"absolute top-2 right-2 h-4 w-4 text-primary"})]},a.id))}),t&&(0,b.jsxs)(i.Tabs,{value:z,onValueChange:a=>A(a),children:[(0,b.jsxs)(i.TabsList,{className:"grid w-full grid-cols-2",children:[(0,b.jsxs)(i.TabsTrigger,{value:"oauth",children:[(0,b.jsx)(k.Link2,{className:"mr-2 h-4 w-4"}),"Quick Connect"]}),(0,b.jsxs)(i.TabsTrigger,{value:"manual",children:[(0,b.jsx)(j.Upload,{className:"mr-2 h-4 w-4"}),"Manual Import"]})]}),(0,b.jsx)(i.TabsContent,{value:"oauth",className:"space-y-4",children:"sleeper"===t?(0,b.jsx)("div",{className:"space-y-4",children:0===L.length?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(h.Label,{htmlFor:"sleeper-username",children:"Sleeper Username"}),(0,b.jsxs)("div",{className:"flex gap-2 mt-1",children:[(0,b.jsx)(g.Input,{id:"sleeper-username",placeholder:"Enter your Sleeper username",value:D,onChange:a=>E(a.target.value),onKeyDown:a=>{"Enter"===a.key&&S()}}),(0,b.jsx)(e.Button,{onClick:S,disabled:H||!D,children:H?(0,b.jsx)(l.Loader2,{className:"h-4 w-4 animate-spin"}):"Find Leagues"})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"Enter your Sleeper username (not email) to find your leagues"})]}),J&&(0,b.jsx)("div",{className:"p-3 rounded-lg border border-red-500 bg-red-50 dark:bg-red-950 text-red-700 dark:text-red-300 text-sm",children:J})]}):(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(h.Label,{children:"Select Leagues to Import"}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mb-3",children:["Found ",L.length," league",1!==L.length?"s":""," for @",D]}),(0,b.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:L.map(a=>(0,b.jsxs)("div",{className:"flex items-center space-x-3 p-3 rounded-lg border hover:bg-accent transition-colors",children:[(0,b.jsx)("input",{type:"checkbox",id:a.league_id,checked:N.includes(a.league_id),onChange:b=>{b.target.checked?O([...N,a.league_id]):O(N.filter(b=>b!==a.league_id))},className:"h-4 w-4 rounded border-gray-300"}),(0,b.jsxs)("label",{htmlFor:a.league_id,className:"flex-1 cursor-pointer",children:[(0,b.jsx)("div",{className:"font-medium",children:a.name}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:[a.total_rosters," teams • ",a.season," ",a.season_type]})]})]},a.league_id))})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(e.Button,{onClick:T,disabled:H||0===N.length,className:"flex-1",children:H?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Importing..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j.Upload,{className:"mr-2 h-4 w-4"}),"Import ",N.length," League",1!==N.length?"s":""]})}),(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>{M([]),O([]),K("")},children:"Change User"})]}),J&&(0,b.jsx)("div",{className:"p-3 rounded-lg border border-red-500 bg-red-50 dark:bg-red-950 text-red-700 dark:text-red-300 text-sm",children:J})]})}):(0,b.jsx)("div",{className:"text-center py-8",children:"yahoo"===t?P?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-purple-100 dark:bg-purple-900 mb-4",children:(0,b.jsx)("span",{className:"text-3xl",children:"🟣"})}),(0,b.jsxs)("div",{className:"max-w-md mx-auto space-y-4",children:[(0,b.jsxs)("div",{className:"p-4 rounded-lg bg-yellow-50 dark:bg-yellow-950 border border-yellow-200 dark:border-yellow-800",children:[(0,b.jsx)("h3",{className:"font-semibold mb-2",children:"Yahoo OAuth Not Configured"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-3",children:"To connect real Yahoo leagues, you need to set up OAuth credentials."}),(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:()=>window.open("/teams/import/yahoo/setup","_blank"),className:"w-full mb-2",children:"View Setup Instructions"})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,b.jsx)("span",{className:"w-full border-t"})}),(0,b.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,b.jsx)("span",{className:"bg-background px-2 text-muted-foreground",children:"Or"})})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Try HalGrid with demo data to explore all features"}),(0,b.jsxs)(e.Button,{onClick:()=>{a.A(51104).then(({default:a})=>{a.importTeam("yahoo",{leagueId:`yahoo_demo_${Date.now()}`,teamId:`yahoo_team_${Date.now()}`,leagueName:"Yahoo Demo League"})&&(G(!0),Q(!1),setTimeout(()=>window.location.href="/dashboard",1500))})},className:"w-full bg-purple-500 hover:bg-purple-600",children:[(0,b.jsx)(j.Upload,{className:"mr-2 h-4 w-4"}),"Use Demo Yahoo Team"]})]})]})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-purple-100 dark:bg-purple-900 mb-4",children:(0,b.jsx)("span",{className:"text-3xl",children:"🟣"})}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"Sign in with your Yahoo account to import your fantasy teams"}),(0,b.jsx)(e.Button,{onClick:U,disabled:R.isPending,className:"bg-purple-500 hover:bg-purple-600",children:R.isPending?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Redirecting to Yahoo..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.Link2,{className:"mr-2 h-4 w-4"}),"Sign in with Yahoo"]})}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-4",children:"You'll be redirected to Yahoo to authorize access"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("p",{className:"text-muted-foreground mb-4",children:["We'll securely connect to your ",x.find(a=>a.id===t)?.name," account"]}),(0,b.jsx)(e.Button,{onClick:U,disabled:R.isPending,children:R.isPending?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Connecting..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.Link2,{className:"mr-2 h-4 w-4"}),"Connect to ",x.find(a=>a.id===t)?.name]})})]})})}),(0,b.jsx)(i.TabsContent,{value:"manual",className:"space-y-4",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(h.Label,{htmlFor:"leagueId",children:"League ID"}),(0,b.jsx)(g.Input,{id:"leagueId",placeholder:"Enter your league ID",value:B.leagueId,onChange:a=>C({...B,leagueId:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(h.Label,{htmlFor:"teamId",children:"Team ID"}),(0,b.jsx)(g.Input,{id:"teamId",placeholder:"Enter your team ID",value:B.teamId,onChange:a=>C({...B,teamId:a.target.value})})]}),(0,b.jsx)(e.Button,{onClick:U,className:"w-full",disabled:R.isPending,children:R.isPending?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Importing..."]}):"Import Team"})]})})]})]})]}),"yahoo"===t&&"oauth"===z&&!P&&(0,b.jsxs)(f.Card,{className:"border-purple-200 dark:border-purple-800 bg-purple-50 dark:bg-purple-950/20",children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsxs)(f.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,b.jsx)(n.AlertCircle,{className:"h-5 w-5 text-purple-600"}),"Yahoo Authentication Process"]})}),(0,b.jsxs)(f.CardContent,{className:"space-y-3 text-sm",children:[(0,b.jsx)("p",{children:'When you click "Sign in with Yahoo":'}),(0,b.jsxs)("ol",{className:"list-decimal list-inside space-y-2 text-muted-foreground",children:[(0,b.jsx)("li",{children:"You'll be redirected to Yahoo's secure login page"}),(0,b.jsx)("li",{children:"Sign in with your Yahoo account credentials"}),(0,b.jsx)("li",{children:"Authorize HalGrid to access your fantasy data (read-only)"}),(0,b.jsx)("li",{children:"You'll be redirected back to select which leagues to import"})]}),(0,b.jsx)("div",{className:"pt-2 border-t",children:(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["💡 ",(0,b.jsx)("strong",{children:"Note:"})," We only request read access to your fantasy sports data. We cannot make changes to your teams or leagues."]})})]})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsx)(f.CardTitle,{children:"Upload CSV"}),(0,b.jsx)(f.CardDescription,{children:"Have your roster in a spreadsheet? Upload a CSV file"})]}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)("div",{className:"border-2 border-dashed border-muted-foreground/25 rounded-lg p-8 text-center",children:[(0,b.jsx)(j.Upload,{className:"mx-auto h-12 w-12 text-muted-foreground/50 mb-4"}),(0,b.jsxs)(h.Label,{htmlFor:"csv-upload",className:"cursor-pointer",children:[(0,b.jsx)("span",{className:"text-primary underline",children:"Click to upload"})," or drag and drop"]}),(0,b.jsx)(g.Input,{id:"csv-upload",type:"file",accept:".csv",className:"hidden",onChange:a=>{let b=a.target.files?.[0];if(b){let a=new FileReader;a.onload=a=>{console.log("CSV content:",a.target?.result)},a.readAsText(b)}}}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"CSV files only. Max size: 5MB"})]})})]})]})}function z(){(0,d.useRouter)();let a=(0,d.useSearchParams)().get("platform");return(0,b.jsx)(y,{defaultPlatform:a||void 0})}function A(){return(0,b.jsx)("main",{className:"container mx-auto p-6",children:(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)("div",{children:"Loading..."}),children:(0,b.jsx)(z,{})})})}}];

//# sourceMappingURL=app_teams_import_page_tsx_2761f493._.js.map