module.exports=[78739,a=>{"use strict";a.s(["ESPNRealDataService",()=>e,"espnRealDataService",()=>f]);let b="https://site.api.espn.com/apis/site/v2/sports/football/nfl",c={1:"ATL",2:"BUF",3:"CHI",4:"CIN",5:"CLE",6:"DAL",7:"DEN",8:"DET",9:"GB",10:"TEN",11:"IND",12:"KC",13:"LV",14:"LAR",15:"MIA",16:"MIN",17:"NE",18:"NO",19:"NYG",20:"NYJ",21:"PHI",22:"ARI",23:"PIT",24:"LAC",25:"SF",26:"SEA",27:"TB",28:"WSH",29:"CAR",30:"JAX",33:"BAL",34:"HOU"},d={1:"QB",2:"RB",3:"WR",4:"TE",5:"K",16:"D/ST"};class e{cookies={};constructor(){}setCookies(a,b){this.cookies={espnS2:a,SWID:b}}async fetchWithCookies(a){let b={Accept:"application/json"};this.cookies.espnS2&&this.cookies.SWID&&(b.Cookie=`espn_s2=${this.cookies.espnS2}; SWID=${this.cookies.SWID}`);try{let c=await fetch(a,{headers:b,credentials:"include"});if(!c.ok){let b=await fetch(a,{headers:{Accept:"application/json"}});if(!b.ok)throw Error(`ESPN API error: ${b.status}`);return b.json()}return c.json()}catch(a){throw console.error("ESPN API fetch error:",a),a}}async importLeague(a,b){let c=new Date().getFullYear(),d=[];try{let e=`https://fantasy.espn.com/apis/v3/games/ffl/seasons/${c}/segments/0/leagues/${a}?view=mTeam&view=mRoster&view=mMatchup&view=mSettings&view=mStandings&view=mStatus&view=mLiveScoring`,f=await this.fetchWithCookies(e);if(!f||!f.teams)throw Error("Unable to fetch ESPN league data");let g=f.scoringPeriodId||1;for(let c of f.teams){let e=await this.parseRoster(c.roster?.entries||[]),h=f.schedule?.find(a=>a.matchupPeriodId===Math.ceil(g/1)&&(a.home?.teamId===c.id||a.away?.teamId===c.id)),i=h?.home?.teamId===c.id,j=i?h?.away:h?.home,k={id:`espn-${a}-${c.id}`,name:`${c.location} ${c.nickname}`.trim()||"ESPN Team",platform:"espn",leagueId:a,managerId:c.primaryOwner||"",roster:e,record:{wins:c.record?.overall?.wins||0,losses:c.record?.overall?.losses||0,ties:c.record?.overall?.ties||0},standing:c.playoffSeed||c.rankCalculatedFinal||0,points:{for:c.points||0,against:c.pointsAgainst||0},projectedPoints:h&&(i?h.home?.totalProjectedPoints:h.away?.totalProjectedPoints)||0,livePoints:h&&(i?h.home?.totalPoints:h.away?.totalPoints)||0,matchup:j?{opponentId:`espn-${a}-${j.teamId}`,opponentName:f.teams.find(a=>a.id===j.teamId)?.name||"Opponent",opponentScore:j.totalPoints||0,week:g}:void 0,avatar:c.logo||"",isUserTeam:!!b&&c.id.toString()===b,lastUpdated:new Date().toISOString()};d.push(k)}if(b)return d.filter(a=>a.isUserTeam);return d}catch(a){return console.error("Error importing ESPN league:",a),[]}}async parseRoster(a){let b=[];for(let e of a){if(!e.playerPoolEntry?.player)continue;let a=e.playerPoolEntry.player,f=a.stats?.find(a=>0===a.statSourceId)||{},g="ACTIVE";a.injured&&(g=a.injuryStatus||"QUESTIONABLE");let h={id:`espn-${a.id}`,name:a.fullName,position:d[a.defaultPositionId]||"FLEX",team:c[a.proTeamId]||"FA",jerseyNumber:a.jersey||"",status:{isActive:e.lineupSlotId<20,gameStatus:this.mapInjuryStatus(g),injuryDesignation:"ACTIVE"!==g?g:void 0},points:f.appliedTotal||0,projectedPoints:f.appliedProjectedTotal||0,stats:{passingYards:f.stats?.[3]||0,passingTDs:f.stats?.[4]||0,rushingYards:f.stats?.[24]||0,rushingTDs:f.stats?.[25]||0,receptions:f.stats?.[53]||0,receivingYards:f.stats?.[42]||0,receivingTDs:f.stats?.[43]||0,fantasyPoints:f.appliedTotal||0},percentOwned:a.ownership?.percentOwned||0,percentStarted:a.ownership?.percentStarted||0,avatar:`https://a.espncdn.com/combiner/i?img=/i/headshots/nfl/players/full/${a.id}.png&w=96&h=70`,lastUpdate:new Date().toISOString()};b.push(h)}return b}mapInjuryStatus(a){switch(a?.toUpperCase()){case"ACTIVE":case"PROBABLE":default:return"playing";case"QUESTIONABLE":return"questionable";case"DOUBTFUL":return"doubtful";case"OUT":return"out";case"INJURY_RESERVE":case"IR":return"ir"}}async getLiveScores(){try{let a=await fetch(`${b}/scoreboard`),c=await a.json();return c.events?.map(a=>({id:a.id,name:a.name,shortName:a.shortName,date:a.date,completed:a.status.type.completed,inProgress:"in"===a.status.type.state,period:a.status.period,clock:a.status.displayClock,teams:a.competitions[0].competitors.map(a=>({id:a.team.id,name:a.team.displayName,abbreviation:a.team.abbreviation,score:a.score,homeAway:a.homeAway,winner:a.winner}))}))||[]}catch(a){return console.error("Error fetching ESPN live scores:",a),[]}}async getPlayerNews(a){try{let c=await fetch(`${b}/athletes/${a}/news`),d=await c.json();return d.articles?.map(a=>({headline:a.headline,description:a.description,published:a.published,link:a.links?.web?.href}))||[]}catch(a){return console.error("Error fetching ESPN player news:",a),[]}}}let f=new e}];

//# sourceMappingURL=lib_services_espnRealDataService_ts_037eb602._.js.map