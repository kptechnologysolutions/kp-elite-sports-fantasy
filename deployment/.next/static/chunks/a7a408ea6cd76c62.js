(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,67034,(e,t,n)=>{!function(){var e={675:function(e,t){"use strict";t.byteLength=function(e){var t=l(e),n=t[0],r=t[1];return(n+r)*3/4-r},t.toByteArray=function(e){var t,n,i=l(e),o=i[0],a=i[1],c=new s((o+a)*3/4-a),u=0,h=a>0?o-4:o;for(n=0;n<h;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;return 2===a&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,c[u++]=255&t),1===a&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t),c},t.fromByteArray=function(e){for(var t,r=e.length,s=r%3,i=[],o=0,a=r-s;o<a;o+=16383)i.push(function(e,t,r){for(var s,i=[],o=t;o<r;o+=3)s=(e[o]<<16&0xff0000)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(n[s>>18&63]+n[s>>12&63]+n[s>>6&63]+n[63&s]);return i.join("")}(e,o,o+16383>a?a:o+16383));return 1===s?i.push(n[(t=e[r-1])>>2]+n[t<<4&63]+"=="):2===s&&i.push(n[(t=(e[r-2]<<8)+e[r-1])>>10]+n[t>>4&63]+n[t<<2&63]+"="),i.join("")};for(var n=[],r=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=i.length;o<a;++o)n[o]=i[o],r[i.charCodeAt(o)]=o;function l(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");-1===n&&(n=t);var r=n===t?0:4-n%4;return[n,r]}r[45]=62,r[95]=63},72:function(e,t,n){"use strict";var r=n(675),s=n(783),i="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function o(e){if(e>0x7fffffff)throw RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,a.prototype),t}function a(e,t,n){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return u(e)}return l(e,t,n)}function l(e,t,n){if("string"==typeof e){var r=e,s=t;if(("string"!=typeof s||""===s)&&(s="utf8"),!a.isEncoding(s))throw TypeError("Unknown encoding: "+s);var i=0|f(r,s),l=o(i),c=l.write(r,s);return c!==i&&(l=l.slice(0,c)),l}if(ArrayBuffer.isView(e))return h(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(E(e,ArrayBuffer)||e&&E(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(E(e,SharedArrayBuffer)||e&&E(e.buffer,SharedArrayBuffer)))return function(e,t,n){var r;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),a.prototype),r}(e,t,n);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');var u=e.valueOf&&e.valueOf();if(null!=u&&u!==e)return a.from(u,t,n);var p=function(e){if(a.isBuffer(e)){var t=0|d(e.length),n=o(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||function(e){return e!=e}(e.length)?o(0):h(e):"Buffer"===e.type&&Array.isArray(e.data)?h(e.data):void 0}(e);if(p)return p;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return a.from(e[Symbol.toPrimitive]("string"),t,n);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function c(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return c(e),o(e<0?0:0|d(e))}function h(e){for(var t=e.length<0?0:0|d(e.length),n=o(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}t.Buffer=a,t.SlowBuffer=function(e){return+e!=e&&(e=0),a.alloc(+e)},t.INSPECT_MAX_BYTES=50,t.kMaxLength=0x7fffffff,a.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),a.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}}),a.poolSize=8192,a.from=function(e,t,n){return l(e,t,n)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array),a.alloc=function(e,t,n){return(c(e),e<=0)?o(e):void 0!==t?"string"==typeof n?o(e).fill(t,n):o(e).fill(t):o(e)},a.allocUnsafe=function(e){return u(e)},a.allocUnsafeSlow=function(e){return u(e)};function d(e){if(e>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function f(e,t){if(a.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||E(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var s=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return j(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return I(e).length;default:if(s)return r?-1:j(e).length;t=(""+t).toLowerCase(),s=!0}}function p(e,t,n){var s,i,o,a=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===n||n>this.length)&&(n=this.length),n<=0||(n>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var s="",i=t;i<n;++i)s+=O[e[i]];return s}(this,t,n);case"utf8":case"utf-8":return v(this,t,n);case"ascii":return function(e,t,n){var r="";n=Math.min(e.length,n);for(var s=t;s<n;++s)r+=String.fromCharCode(127&e[s]);return r}(this,t,n);case"latin1":case"binary":return function(e,t,n){var r="";n=Math.min(e.length,n);for(var s=t;s<n;++s)r+=String.fromCharCode(e[s]);return r}(this,t,n);case"base64":return s=this,i=t,o=n,0===i&&o===s.length?r.fromByteArray(s):r.fromByteArray(s.slice(i,o));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,n){for(var r=e.slice(t,n),s="",i=0;i<r.length;i+=2)s+=String.fromCharCode(r[i]+256*r[i+1]);return s}(this,t,n);default:if(a)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),a=!0}}function m(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function g(e,t,n,r,s){var i;if(0===e.length)return -1;if("string"==typeof n?(r=n,n=0):n>0x7fffffff?n=0x7fffffff:n<-0x80000000&&(n=-0x80000000),(i=n*=1)!=i&&(n=s?0:e.length-1),n<0&&(n=e.length+n),n>=e.length)if(s)return -1;else n=e.length-1;else if(n<0)if(!s)return -1;else n=0;if("string"==typeof t&&(t=a.from(t,r)),a.isBuffer(t))return 0===t.length?-1:y(e,t,n,r,s);if("number"==typeof t){if(t&=255,"function"==typeof Uint8Array.prototype.indexOf)if(s)return Uint8Array.prototype.indexOf.call(e,t,n);else return Uint8Array.prototype.lastIndexOf.call(e,t,n);return y(e,[t],n,r,s)}throw TypeError("val must be string, number or Buffer")}function y(e,t,n,r,s){var i,o=1,a=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return -1;o=2,a/=2,l/=2,n/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(s){var u=-1;for(i=n;i<a;i++)if(c(e,i)===c(t,-1===u?0:i-u)){if(-1===u&&(u=i),i-u+1===l)return u*o}else -1!==u&&(i-=i-u),u=-1}else for(n+l>a&&(n=a-l),i=n;i>=0;i--){for(var h=!0,d=0;d<l;d++)if(c(e,i+d)!==c(t,d)){h=!1;break}if(h)return i}return -1}a.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==a.prototype},a.compare=function(e,t){if(E(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),E(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(e)||!a.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,s=0,i=Math.min(n,r);s<i;++s)if(e[s]!==t[s]){n=e[s],r=t[s];break}return n<r?-1:+(r<n)},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);if(void 0===t)for(n=0,t=0;n<e.length;++n)t+=e[n].length;var n,r=a.allocUnsafe(t),s=0;for(n=0;n<e.length;++n){var i=e[n];if(E(i,Uint8Array)&&(i=a.from(i)),!a.isBuffer(i))throw TypeError('"list" argument must be an Array of Buffers');i.copy(r,s),s+=i.length}return r},a.byteLength=f,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},a.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},a.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},a.prototype.toString=function(){var e=this.length;return 0===e?"":0==arguments.length?v(this,0,e):p.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(e){if(!a.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},i&&(a.prototype[i]=a.prototype.inspect),a.prototype.compare=function(e,t,n,r,s){if(E(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===s&&(s=this.length),t<0||n>e.length||r<0||s>this.length)throw RangeError("out of range index");if(r>=s&&t>=n)return 0;if(r>=s)return -1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,s>>>=0,this===e)return 0;for(var i=s-r,o=n-t,l=Math.min(i,o),c=this.slice(r,s),u=e.slice(t,n),h=0;h<l;++h)if(c[h]!==u[h]){i=c[h],o=u[h];break}return i<o?-1:+(o<i)},a.prototype.includes=function(e,t,n){return -1!==this.indexOf(e,t,n)},a.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},a.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)};function v(e,t,n){n=Math.min(e.length,n);for(var r=[],s=t;s<n;){var i,o,a,l,c=e[s],u=null,h=c>239?4:c>223?3:c>191?2:1;if(s+h<=n)switch(h){case 1:c<128&&(u=c);break;case 2:(192&(i=e[s+1]))==128&&(l=(31&c)<<6|63&i)>127&&(u=l);break;case 3:i=e[s+1],o=e[s+2],(192&i)==128&&(192&o)==128&&(l=(15&c)<<12|(63&i)<<6|63&o)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:i=e[s+1],o=e[s+2],a=e[s+3],(192&i)==128&&(192&o)==128&&(192&a)==128&&(l=(15&c)<<18|(63&i)<<12|(63&o)<<6|63&a)>65535&&l<1114112&&(u=l)}null===u?(u=65533,h=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),s+=h}var d=r,f=d.length;if(f<=4096)return String.fromCharCode.apply(String,d);for(var p="",m=0;m<f;)p+=String.fromCharCode.apply(String,d.slice(m,m+=4096));return p}function w(e,t,n){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>n)throw RangeError("Trying to access beyond buffer length")}function b(e,t,n,r,s,i){if(!a.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>s||t<i)throw RangeError('"value" argument is out of bounds');if(n+r>e.length)throw RangeError("Index out of range")}function _(e,t,n,r,s,i){if(n+r>e.length||n<0)throw RangeError("Index out of range")}function x(e,t,n,r,i){return t*=1,n>>>=0,i||_(e,t,n,4,34028234663852886e22,-34028234663852886e22),s.write(e,t,n,r,23,4),n+4}function S(e,t,n,r,i){return t*=1,n>>>=0,i||_(e,t,n,8,17976931348623157e292,-17976931348623157e292),s.write(e,t,n,r,52,8),n+8}a.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var s,i,o,a,l,c,u,h,d=this.length-t;if((void 0===n||n>d)&&(n=d),e.length>0&&(n<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var f=!1;;)switch(r){case"hex":return function(e,t,n,r){n=Number(n)||0;var s=e.length-n;r?(r=Number(r))>s&&(r=s):r=s;var i=t.length;r>i/2&&(r=i/2);for(var o=0;o<r;++o){var a,l=parseInt(t.substr(2*o,2),16);if((a=l)!=a)break;e[n+o]=l}return o}(this,e,t,n);case"utf8":case"utf-8":return s=t,i=n,R(j(e,this.length-s),this,s,i);case"ascii":return o=t,a=n,R(P(e),this,o,a);case"latin1":case"binary":return function(e,t,n,r){return R(P(t),e,n,r)}(this,e,t,n);case"base64":return l=t,c=n,R(I(e),this,l,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return u=t,h=n,R(function(e,t){for(var n,r,s=[],i=0;i<e.length&&!((t-=2)<0);++i)r=(n=e.charCodeAt(i))>>8,s.push(n%256),s.push(r);return s}(e,this.length-u),this,u,h);default:if(f)throw TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),f=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},a.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return Object.setPrototypeOf(r,a.prototype),r},a.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||w(e,t,this.length);for(var r=this[e],s=1,i=0;++i<t&&(s*=256);)r+=this[e+i]*s;return r},a.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||w(e,t,this.length);for(var r=this[e+--t],s=1;t>0&&(s*=256);)r+=this[e+--t]*s;return r},a.prototype.readUInt8=function(e,t){return e>>>=0,t||w(e,1,this.length),this[e]},a.prototype.readUInt16LE=function(e,t){return e>>>=0,t||w(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUInt16BE=function(e,t){return e>>>=0,t||w(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUInt32LE=function(e,t){return e>>>=0,t||w(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+0x1000000*this[e+3]},a.prototype.readUInt32BE=function(e,t){return e>>>=0,t||w(e,4,this.length),0x1000000*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||w(e,t,this.length);for(var r=this[e],s=1,i=0;++i<t&&(s*=256);)r+=this[e+i]*s;return r>=(s*=128)&&(r-=Math.pow(2,8*t)),r},a.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||w(e,t,this.length);for(var r=t,s=1,i=this[e+--r];r>0&&(s*=256);)i+=this[e+--r]*s;return i>=(s*=128)&&(i-=Math.pow(2,8*t)),i},a.prototype.readInt8=function(e,t){return(e>>>=0,t||w(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},a.prototype.readInt16LE=function(e,t){e>>>=0,t||w(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?0xffff0000|n:n},a.prototype.readInt16BE=function(e,t){e>>>=0,t||w(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?0xffff0000|n:n},a.prototype.readInt32LE=function(e,t){return e>>>=0,t||w(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return e>>>=0,t||w(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readFloatLE=function(e,t){return e>>>=0,t||w(e,4,this.length),s.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return e>>>=0,t||w(e,4,this.length),s.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return e>>>=0,t||w(e,8,this.length),s.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return e>>>=0,t||w(e,8,this.length),s.read(this,e,!1,52,8)},a.prototype.writeUIntLE=function(e,t,n,r){if(e*=1,t>>>=0,n>>>=0,!r){var s=Math.pow(2,8*n)-1;b(this,e,t,n,s,0)}var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},a.prototype.writeUIntBE=function(e,t,n,r){if(e*=1,t>>>=0,n>>>=0,!r){var s=Math.pow(2,8*n)-1;b(this,e,t,n,s,0)}var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},a.prototype.writeUInt8=function(e,t,n){return e*=1,t>>>=0,n||b(this,e,t,1,255,0),this[t]=255&e,t+1},a.prototype.writeUInt16LE=function(e,t,n){return e*=1,t>>>=0,n||b(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeUInt16BE=function(e,t,n){return e*=1,t>>>=0,n||b(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeUInt32LE=function(e,t,n){return e*=1,t>>>=0,n||b(this,e,t,4,0xffffffff,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},a.prototype.writeUInt32BE=function(e,t,n){return e*=1,t>>>=0,n||b(this,e,t,4,0xffffffff,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeIntLE=function(e,t,n,r){if(e*=1,t>>>=0,!r){var s=Math.pow(2,8*n-1);b(this,e,t,n,s-1,-s)}var i=0,o=1,a=0;for(this[t]=255&e;++i<n&&(o*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/o|0)-a&255;return t+n},a.prototype.writeIntBE=function(e,t,n,r){if(e*=1,t>>>=0,!r){var s=Math.pow(2,8*n-1);b(this,e,t,n,s-1,-s)}var i=n-1,o=1,a=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/o|0)-a&255;return t+n},a.prototype.writeInt8=function(e,t,n){return e*=1,t>>>=0,n||b(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,n){return e*=1,t>>>=0,n||b(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeInt16BE=function(e,t,n){return e*=1,t>>>=0,n||b(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeInt32LE=function(e,t,n){return e*=1,t>>>=0,n||b(this,e,t,4,0x7fffffff,-0x80000000),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},a.prototype.writeInt32BE=function(e,t,n){return e*=1,t>>>=0,n||b(this,e,t,4,0x7fffffff,-0x80000000),e<0&&(e=0xffffffff+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeFloatLE=function(e,t,n){return x(this,e,t,!0,n)},a.prototype.writeFloatBE=function(e,t,n){return x(this,e,t,!1,n)},a.prototype.writeDoubleLE=function(e,t,n){return S(this,e,t,!0,n)},a.prototype.writeDoubleBE=function(e,t,n){return S(this,e,t,!1,n)},a.prototype.copy=function(e,t,n,r){if(!a.isBuffer(e))throw TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw RangeError("Index out of range");if(r<0)throw RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var s=r-n;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,n,r);else if(this===e&&n<t&&t<r)for(var i=s-1;i>=0;--i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,r),t);return s},a.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw TypeError("encoding must be a string");if("string"==typeof r&&!a.isEncoding(r))throw TypeError("Unknown encoding: "+r);if(1===e.length){var s,i=e.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(e=i)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw RangeError("Out of range index");if(n<=t)return this;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(s=t;s<n;++s)this[s]=e;else{var o=a.isBuffer(e)?e:a.from(e,r),l=o.length;if(0===l)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<n-t;++s)this[s+t]=o[s%l]}return this};var A=/[^+/0-9A-Za-z-_]/g;function j(e,t){t=t||1/0;for(var n,r=e.length,s=null,i=[],o=0;o<r;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!s){if(n>56319||o+1===r){(t-=3)>-1&&i.push(239,191,189);continue}s=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),s=n;continue}n=(s-55296<<10|n-56320)+65536}else s&&(t-=3)>-1&&i.push(239,191,189);if(s=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else if(n<1114112){if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}else throw Error("Invalid code point")}return i}function P(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function I(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(A,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function R(e,t,n,r){for(var s=0;s<r&&!(s+n>=t.length)&&!(s>=e.length);++s)t[s+n]=e[s];return s}function E(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}var O=function(){for(var e="0123456789abcdef",t=Array(256),n=0;n<16;++n)for(var r=16*n,s=0;s<16;++s)t[r+s]=e[n]+e[s];return t}()},783:function(e,t){t.read=function(e,t,n,r,s){var i,o,a=8*s-r-1,l=(1<<a)-1,c=l>>1,u=-7,h=n?s-1:0,d=n?-1:1,f=e[t+h];for(h+=d,i=f&(1<<-u)-1,f>>=-u,u+=a;u>0;i=256*i+e[t+h],h+=d,u-=8);for(o=i&(1<<-u)-1,i>>=-u,u+=r;u>0;o=256*o+e[t+h],h+=d,u-=8);if(0===i)i=1-c;else{if(i===l)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,r),i-=c}return(f?-1:1)*o*Math.pow(2,i-r)},t.write=function(e,t,n,r,s,i){var o,a,l,c=8*i-s-1,u=(1<<c)-1,h=u>>1,d=5960464477539062e-23*(23===s),f=r?0:i-1,p=r?1:-1,m=+(t<0||0===t&&1/t<0);for(isNaN(t=Math.abs(t))||t===1/0?(a=+!!isNaN(t),o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+h>=1?t+=d/l:t+=d*Math.pow(2,1-h),t*l>=2&&(o++,l/=2),o+h>=u?(a=0,o=u):o+h>=1?(a=(t*l-1)*Math.pow(2,s),o+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,s),o=0));s>=8;e[n+f]=255&a,f+=p,a/=256,s-=8);for(o=o<<s|a,c+=s;c>0;e[n+f]=255&o,f+=p,o/=256,c-=8);e[n+f-p]|=128*m}}},n={};function r(t){var s=n[t];if(void 0!==s)return s.exports;var i=n[t]={exports:{}},o=!0;try{e[t](i,i.exports,r),o=!1}finally{o&&delete n[t]}return i.exports}r.ab="/ROOT/node_modules/next/dist/compiled/buffer/",t.exports=r(72)}()},12833,e=>{"use strict";let t,n,r,s;e.s(["default",()=>s1],12833);var i,o,a,l,c,u,h,d,f,p,m,g,y,v,w,b,_,x,S,A,j,P,I,R,E,O,k,N,T,C,B,M,L,U,D,W,F,q,X,H,J,z,K,V,Y,$,G,Q,Z,ee,et,en,er,es,ei,eo,ea,el,ec,eu,eh,ed,ef,ep,em,eg,ey,ev,ew,eb,e_,ex,eS,eA,ej,eP,eI,eR,eE,eO=e.i(43476),ek=e.i(71645),eN=e.i(47280),eT=e.i(70065),eC=e.i(67881),eB=e.i(94179),eM=e.i(27341),eL=e.i(87336),eU=e.i(68451),eD=e.i(47167);function eW(e,t,n,r,s){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n}function eF(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}let eq=function(){let{crypto:e}=globalThis;if(null==e?void 0:e.randomUUID)return eq=e.randomUUID.bind(e),e.randomUUID();let t=new Uint8Array(1),n=e?()=>e.getRandomValues(t)[0]:()=>255*Math.random()&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(e^n()&15>>e/4).toString(16))};function eX(e){return"object"==typeof e&&null!==e&&("name"in e&&"AbortError"===e.name||"message"in e&&String(e.message).includes("FetchRequestCanceledException"))}let eH=e=>{if(e instanceof Error)return e;if("object"==typeof e&&null!==e){try{if("[object Error]"===Object.prototype.toString.call(e)){let t=Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch(e){}try{return Error(JSON.stringify(e))}catch(e){}}return Error(e)};class eJ extends Error{}class ez extends eJ{static makeMessage(e,t,n){let r=(null==t?void 0:t.message)?"string"==typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&r?"".concat(e," ").concat(r):e?"".concat(e," status code (no body)"):r||"(no status code or body)"}static generate(e,t,n,r){if(!e||!r)return new eV({message:n,cause:eH(t)});let s=null==t?void 0:t.error;return 400===e?new e$(e,s,n,r):401===e?new eG(e,s,n,r):403===e?new eQ(e,s,n,r):404===e?new eZ(e,s,n,r):409===e?new e0(e,s,n,r):422===e?new e1(e,s,n,r):429===e?new e2(e,s,n,r):e>=500?new e5(e,s,n,r):new ez(e,s,n,r)}constructor(e,t,n,r){super("".concat(ez.makeMessage(e,t,n))),this.status=e,this.headers=r,this.requestID=null==r?void 0:r.get("x-request-id"),this.error=t,this.code=null==t?void 0:t.code,this.param=null==t?void 0:t.param,this.type=null==t?void 0:t.type}}class eK extends ez{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class eV extends ez{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class eY extends eV{constructor({message:e}={}){super({message:null!=e?e:"Request timed out."})}}class e$ extends ez{}class eG extends ez{}class eQ extends ez{}class eZ extends ez{}class e0 extends ez{}class e1 extends ez{}class e2 extends ez{}class e5 extends ez{}class e8 extends eJ{constructor(){super("Could not parse response content as the length limit was reached")}}class e3 extends eJ{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class e6 extends Error{constructor(e){super(e)}}let e4=/^[a-z][a-z0-9+.-]*:/i,e7=e=>(e7=Array.isArray)(e),e9=e7;function te(e){return"object"!=typeof e?{}:null!=e?e:{}}function tt(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)}let tn=e=>new Promise(t=>setTimeout(t,e)),tr="5.23.1",ts=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?"other:".concat(e):"unknown",ti=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?"Other:".concat(e):"Unknown";function to(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let r=globalThis.ReadableStream;if(void 0===r)throw Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new r(...t)}function ta(e){let t=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator]();return to({start(){},async pull(e){let{done:n,value:r}=await t.next();n?e.close():e.enqueue(r)},async cancel(){var e;await (null==(e=t.return)?void 0:e.call(t))}})}function tl(e){if(e[Symbol.asyncIterator])return e;let t=e.getReader();return{async next(){try{let e=await t.read();return(null==e?void 0:e.done)&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){let e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function tc(e){if(null===e||"object"!=typeof e)return;if(e[Symbol.asyncIterator]){var t,n;await (null==(t=(n=e[Symbol.asyncIterator]()).return)?void 0:t.call(n));return}let r=e.getReader(),s=r.cancel();r.releaseLock(),await s}let tu=e=>{let{headers:t,body:n}=e;return{bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(n)}},th="RFC3986",td=e=>String(e),tf={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:td},tp=(e,t)=>{var n;return(tp=null!=(n=Object.hasOwn)?n:Function.prototype.call.bind(Object.prototype.hasOwnProperty))(e,t)},tm=(()=>{let e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})();function tg(e,t){if(e7(e)){let n=[];for(let r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)}let ty={brackets:e=>String(e)+"[]",comma:"comma",indices:(e,t)=>String(e)+"["+t+"]",repeat:e=>String(e)},tv=function(e,t){Array.prototype.push.apply(e,e7(t)?t:[t])},tw={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:(e,t,n,r,s)=>{if(0===e.length)return e;let i=e;if("symbol"==typeof e?i=Symbol.prototype.toString.call(e):"string"!=typeof e&&(i=String(e)),"iso-8859-1"===n)return escape(i).replace(/%u[0-9a-f]{4}/gi,function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"});let o="";for(let e=0;e<i.length;e+=1024){let t=i.length>=1024?i.slice(e,e+1024):i,n=[];for(let e=0;e<t.length;++e){let r=t.charCodeAt(e);if(45===r||46===r||95===r||126===r||r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122||"RFC1738"===s&&(40===r||41===r)){n[n.length]=t.charAt(e);continue}if(r<128){n[n.length]=tm[r];continue}if(r<2048){n[n.length]=tm[192|r>>6]+tm[128|63&r];continue}if(r<55296||r>=57344){n[n.length]=tm[224|r>>12]+tm[128|r>>6&63]+tm[128|63&r];continue}e+=1,r=65536+((1023&r)<<10|1023&t.charCodeAt(e)),n[n.length]=tm[240|r>>18]+tm[128|r>>12&63]+tm[128|r>>6&63]+tm[128|63&r]}o+=n.join("")}return o},encodeValuesOnly:!1,format:th,formatter:td,indices:!1,serializeDate:e=>(null!=n?n:n=Function.prototype.call.bind(Date.prototype.toISOString))(e),skipNulls:!1,strictNullHandling:!1},tb={};function t_(e){let t;return(null!=r?r:r=(t=new globalThis.TextEncoder).encode.bind(t))(e)}function tx(e){let t;return(null!=s?s:s=(t=new globalThis.TextDecoder).decode.bind(t))(e)}class tS{decode(e){let t;if(null==e)return[];let n=e instanceof ArrayBuffer?new Uint8Array(e):"string"==typeof e?t_(e):e;eW(this,i,function(e){let t=0;for(let n of e)t+=n.length;let n=new Uint8Array(t),r=0;for(let t of e)n.set(t,r),r+=t.length;return n}([eF(this,i,"f"),n]),"f");let r=[];for(;null!=(t=function(e,t){for(let n=null!=t?t:0;n<e.length;n++){if(10===e[n])return{preceding:n,index:n+1,carriage:!1};if(13===e[n])return{preceding:n,index:n+1,carriage:!0}}return null}(eF(this,i,"f"),eF(this,o,"f")));){if(t.carriage&&null==eF(this,o,"f")){eW(this,o,t.index,"f");continue}if(null!=eF(this,o,"f")&&(t.index!==eF(this,o,"f")+1||t.carriage)){r.push(tx(eF(this,i,"f").subarray(0,eF(this,o,"f")-1))),eW(this,i,eF(this,i,"f").subarray(eF(this,o,"f")),"f"),eW(this,o,null,"f");continue}let e=null!==eF(this,o,"f")?t.preceding-1:t.preceding,n=tx(eF(this,i,"f").subarray(0,e));r.push(n),eW(this,i,eF(this,i,"f").subarray(t.index),"f"),eW(this,o,null,"f")}return r}flush(){return eF(this,i,"f").length?this.decode("\n"):[]}constructor(){i.set(this,void 0),o.set(this,void 0),eW(this,i,new Uint8Array,"f"),eW(this,o,null,"f")}}i=new WeakMap,o=new WeakMap,tS.NEWLINE_CHARS=new Set(["\n","\r"]),tS.NEWLINE_REGEXP=/\r\n|[\n\r]/g;let tA={off:0,error:200,warn:300,info:400,debug:500},tj=(e,t,n)=>{if(e){if(Object.prototype.hasOwnProperty.call(tA,e))return e;tO(n).warn("".concat(t," was set to ").concat(JSON.stringify(e),", expected one of ").concat(JSON.stringify(Object.keys(tA))))}};function tP(){}function tI(e,t,n){return!t||tA[e]>tA[n]?tP:t[e].bind(t)}let tR={error:tP,warn:tP,info:tP,debug:tP},tE=new WeakMap;function tO(e){var t;let n=e.logger,r=null!=(t=e.logLevel)?t:"off";if(!n)return tR;let s=tE.get(n);if(s&&s[0]===r)return s[1];let i={error:tI("error",n,r),warn:tI("warn",n,r),info:tI("info",n,r),debug:tI("debug",n,r)};return tE.set(n,[r,i]),i}let tk=e=>(e.options&&(e.options={...e.options},delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(e=>{let[t,n]=e;return[t,"authorization"===t.toLowerCase()||"cookie"===t.toLowerCase()||"set-cookie"===t.toLowerCase()?"***":n]}))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e);class tN{static fromSSEResponse(e,t,n){let r=!1,s=n?tO(n):console;async function*i(){if(r)throw new eJ("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let n=!1;try{for await(let r of tT(e,t))if(!n){if(r.data.startsWith("[DONE]")){n=!0;continue}if(null!==r.event&&r.event.startsWith("thread.")){let e;try{e=JSON.parse(r.data)}catch(e){throw console.error("Could not parse message into JSON:",r.data),console.error("From chunk:",r.raw),e}if("error"==r.event)throw new ez(void 0,e.error,e.message,void 0);yield{event:r.event,data:e}}else{let t;try{t=JSON.parse(r.data)}catch(e){throw s.error("Could not parse message into JSON:",r.data),s.error("From chunk:",r.raw),e}if(t&&t.error)throw new ez(void 0,t.error,void 0,e.headers);yield t}}n=!0}catch(e){if(eX(e))return;throw e}finally{n||t.abort()}}return new tN(i,t,n)}static fromReadableStream(e,t,n){let r=!1;async function*s(){let t=new tS;for await(let n of tl(e))for(let e of t.decode(n))yield e;for(let e of t.flush())yield e}return new tN(async function*(){if(r)throw new eJ("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let e=!1;try{for await(let t of s())!e&&t&&(yield JSON.parse(t));e=!0}catch(e){if(eX(e))return;throw e}finally{e||t.abort()}},t,n)}[(a=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){let e=[],t=[],n=this.iterator(),r=r=>({next:()=>{if(0===r.length){let r=n.next();e.push(r),t.push(r)}return r.shift()}});return[new tN(()=>r(e),this.controller,eF(this,a,"f")),new tN(()=>r(t),this.controller,eF(this,a,"f"))]}toReadableStream(){let e,t=this;return to({async start(){e=t[Symbol.asyncIterator]()},async pull(t){try{let{value:n,done:r}=await e.next();if(r)return t.close();let s=t_(JSON.stringify(n)+"\n");t.enqueue(s)}catch(e){t.error(e)}},async cancel(){var t;await (null==(t=e.return)?void 0:t.call(e))}})}constructor(e,t,n){this.iterator=e,a.set(this,void 0),this.controller=t,eW(this,a,n,"f")}}async function*tT(e,t){if(!e.body){if(t.abort(),void 0!==globalThis.navigator&&"ReactNative"===globalThis.navigator.product)throw new eJ("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api");throw new eJ("Attempted to iterate over a response with no body")}let n=new tB,r=new tS;for await(let t of tC(tl(e.body)))for(let e of r.decode(t)){let t=n.decode(e);t&&(yield t)}for(let e of r.flush()){let t=n.decode(e);t&&(yield t)}}async function*tC(e){let t=new Uint8Array;for await(let n of e){let e;if(null==n)continue;let r=n instanceof ArrayBuffer?new Uint8Array(n):"string"==typeof n?t_(n):n,s=new Uint8Array(t.length+r.length);for(s.set(t),s.set(r,t.length),t=s;-1!==(e=function(e){for(let t=0;t<e.length-1;t++){if(10===e[t]&&10===e[t+1]||13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return -1}(t));)yield t.slice(0,e),t=t.slice(e)}t.length>0&&(yield t)}class tB{decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,r]=function(e,t){let n=e.indexOf(":");return -1!==n?[e.substring(0,n),t,e.substring(n+t.length)]:[e,"",""]}(e,":");return r.startsWith(" ")&&(r=r.substring(1)),"event"===t?this.event=r:"data"===t&&this.data.push(r),null}constructor(){this.event=null,this.data=[],this.chunks=[]}}async function tM(e,t){let{response:n,requestLogID:r,retryOfRequestLogID:s,startTime:i}=t,o=await (async()=>{var r;if(t.options.stream)return(tO(e).debug("response",n.status,n.url,n.headers,n.body),t.options.__streamClass)?t.options.__streamClass.fromSSEResponse(n,t.controller,e):tN.fromSSEResponse(n,t.controller,e);if(204===n.status)return null;if(t.options.__binaryResponse)return n;let s=n.headers.get("content-type"),i=null==s||null==(r=s.split(";")[0])?void 0:r.trim();return(null==i?void 0:i.includes("application/json"))||(null==i?void 0:i.endsWith("+json"))?tL(await n.json(),n):await n.text()})();return tO(e).debug("[".concat(r,"] response parsed"),tk({retryOfRequestLogID:s,url:n.url,status:n.status,body:o,durationMs:Date.now()-i})),o}function tL(e,t){return!e||"object"!=typeof e||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}class tU extends Promise{_thenUnwrap(e){return new tU(eF(this,l,"f"),this.responsePromise,async(t,n)=>tL(e(await this.parseResponse(t,n),n),n.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){let[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(eF(this,l,"f"),e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}constructor(e,t,n=tM){super(e=>{e(null)}),this.responsePromise=t,this.parseResponse=n,l.set(this,void 0),eW(this,l,e,"f")}}l=new WeakMap;class tD{hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageRequestOptions()}async getNextPage(){let e=this.nextPageRequestOptions();if(!e)throw new eJ("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await eF(this,c,"f").requestAPIList(this.constructor,e)}async *iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async *[(c=new WeakMap,Symbol.asyncIterator)](){for await(let e of this.iterPages())for(let t of e.getPaginatedItems())yield t}constructor(e,t,n,r){c.set(this,void 0),eW(this,c,e,"f"),this.options=r,this.response=t,this.body=n}}class tW extends tU{async *[Symbol.asyncIterator](){for await(let e of(await this))yield e}constructor(e,t,n){super(e,t,async(e,t)=>new n(e,t.response,await tM(e,t),t.options))}}class tF extends tD{getPaginatedItems(){var e;return null!=(e=this.data)?e:[]}nextPageRequestOptions(){return null}constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.object=n.object}}class tq extends tD{getPaginatedItems(){var e;return null!=(e=this.data)?e:[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageRequestOptions(){var e;let t=this.getPaginatedItems(),n=null==(e=t[t.length-1])?void 0:e.id;return n?{...this.options,query:{...te(this.options.query),after:n}}:null}constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.has_more=n.has_more||!1}}class tX extends tD{getPaginatedItems(){var e;return null!=(e=this.data)?e:[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageRequestOptions(){let e=this.last_id;return e?{...this.options,query:{...te(this.options.query),after:e}}:null}constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.has_more=n.has_more||!1,this.last_id=n.last_id||""}}let tH=()=>{if("undefined"==typeof File){var e;let{process:t}=globalThis;throw Error("`File` is not defined as a global, which is required for file uploads."+("string"==typeof(null==t||null==(e=t.versions)?void 0:e.node)&&20>parseInt(t.versions.node.split("."))?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function tJ(e,t,n){return tH(),new File(e,null!=t?t:"unknown_file",n)}function tz(e){return("object"==typeof e&&null!==e&&("name"in e&&e.name&&String(e.name)||"url"in e&&e.url&&String(e.url)||"filename"in e&&e.filename&&String(e.filename)||"path"in e&&e.path&&String(e.path))||"").split(/[\\/]/).pop()||void 0}let tK=e=>null!=e&&"object"==typeof e&&"function"==typeof e[Symbol.asyncIterator],tV=async(e,t)=>({...e,body:await t$(e.body,t)}),tY=new WeakMap,t$=async(e,t)=>{if(!await function(e){let t="function"==typeof e?e:e.fetch,n=tY.get(t);if(n)return n;let r=(async()=>{try{let e="Response"in t?t.Response:(await t("data:,")).constructor,n=new FormData;if(n.toString()===await new e(n).text())return!1;return!0}catch(e){return!0}})();return tY.set(t,r),r}(t))throw TypeError("The provided fetch function does not support file uploads with the current global FormData class.");let n=new FormData;return await Promise.all(Object.entries(e||{}).map(e=>{let[t,r]=e;return tZ(n,t,r)})),n},tG=e=>e instanceof Blob&&"name"in e,tQ=e=>{if((e=>"object"==typeof e&&null!==e&&(e instanceof Response||tK(e)||tG(e)))(e))return!0;if(Array.isArray(e))return e.some(tQ);if(e&&"object"==typeof e){for(let t in e)if(tQ(e[t]))return!0}return!1},tZ=async(e,t,n)=>{if(void 0!==n){if(null==n)throw TypeError('Received null for "'.concat(t,"\"; to pass null in FormData, you must use the string 'null'"));if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)e.append(t,String(n));else if(n instanceof Response)e.append(t,tJ([await n.blob()],tz(n)));else if(tK(n))e.append(t,tJ([await new Response(ta(n)).blob()],tz(n)));else if(tG(n))e.append(t,n,tz(n));else if(Array.isArray(n))await Promise.all(n.map(n=>tZ(e,t+"[]",n)));else if("object"==typeof n)await Promise.all(Object.entries(n).map(n=>{let[r,s]=n;return tZ(e,"".concat(t,"[").concat(r,"]"),s)}));else throw TypeError("Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ".concat(n," instead"))}},t0=e=>null!=e&&"object"==typeof e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.text&&"function"==typeof e.slice&&"function"==typeof e.arrayBuffer;async function t1(e,t,n){let r,s;if(tH(),null!=(r=e=await e)&&"object"==typeof r&&"string"==typeof r.name&&"number"==typeof r.lastModified&&t0(r))return e instanceof File?e:tJ([await e.arrayBuffer()],e.name);if(null!=(s=e)&&"object"==typeof s&&"string"==typeof s.url&&"function"==typeof s.blob){let r=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),tJ(await t2(r),t,n)}let i=await t2(e);if(t||(t=tz(e)),!(null==n?void 0:n.type)){let e=i.find(e=>"object"==typeof e&&"type"in e&&e.type);"string"==typeof e&&(n={...n,type:e})}return tJ(i,t,n)}async function t2(e){let t=[];if("string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(t0(e))t.push(e instanceof Blob?e:await e.arrayBuffer());else if(tK(e))for await(let n of e)t.push(...await t2(n));else{var n;let t=null==e||null==(n=e.constructor)?void 0:n.name;throw Error("Unexpected data type: ".concat(typeof e).concat(t?"; constructor: ".concat(t):"").concat(function(e){if("object"!=typeof e||null===e)return"";let t=Object.getOwnPropertyNames(e);return"; props: [".concat(t.map(e=>'"'.concat(e,'"')).join(", "),"]")}(e)))}return t}e.s([],30742);class t5{constructor(e){this._client=e}}function t8(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function t3(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}let t6=Object.freeze(Object.create(null)),t4=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t3;return function(t){let n;for(var r=arguments.length,s=Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];if(1===t.length)return t[0];let o=!1,a=[],l=t.reduce((t,n,r)=>{var i,l,c;/[?#]/.test(n)&&(o=!0);let u=s[r],h=(o?encodeURIComponent:e)(""+u);return r!==s.length&&(null==u||"object"==typeof u&&u.toString===(null==(i=Object.getPrototypeOf(null!=(c=Object.getPrototypeOf(null!=(l=u.hasOwnProperty)?l:t6))?c:t6))?void 0:i.toString))&&(h=u+"",a.push({start:t.length+n.length,length:h.length,error:"Value of type ".concat(Object.prototype.toString.call(u).slice(8,-1)," is not a valid path parameter")})),t+n+(r===s.length?"":h)},""),c=l.split(/[?#]/,1)[0],u=RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");for(;null!==(n=u.exec(c));)a.push({start:n.index,length:n[0].length,error:'Value "'.concat(n[0],"\" can't be safely passed as a path parameter")});if(a.sort((e,t)=>e.start-t.start),a.length>0){let e=0,t=a.reduce((t,n)=>{let r=" ".repeat(n.start-e),s="^".repeat(n.length);return e=n.start+n.length,t+r+s},"");throw new eJ("Path parameters result in path with invalid segments:\n".concat(a.map(e=>e.error).join("\n"),"\n").concat(l,"\n").concat(t))}return l}}(t3);function t7(){let e=t8(["/chat/completions/","/messages"]);return t7=function(){return e},e}class t9 extends t5{list(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return this._client.getAPIList(t4(t7(),e),tq,{query:t,...n})}}function ne(e){return void 0!==e&&"function"in e&&void 0!==e.function}function nt(e){return(null==e?void 0:e.$brand)==="auto-parseable-response-format"}function nn(e){return(null==e?void 0:e.$brand)==="auto-parseable-tool"}function nr(e,t){let n=e.choices.map(e=>{var n,r,s,i,o,a;if("length"===e.finish_reason)throw new e8;if("content_filter"===e.finish_reason)throw new e3;return ni(e.message.tool_calls),{...e,message:{...e.message,...e.message.tool_calls?{tool_calls:null!=(r=null==(n=e.message.tool_calls)?void 0:n.map(e=>(function(e,t){var n;let r=null==(n=e.tools)?void 0:n.find(e=>{var n;return ne(e)&&(null==(n=e.function)?void 0:n.name)===t.function.name});return{...t,function:{...t.function,parsed_arguments:nn(r)?r.$parseRaw(t.function.arguments):(null==r?void 0:r.function.strict)?JSON.parse(t.function.arguments):null}}})(t,e)))?r:void 0}:void 0,parsed:e.message.content&&!e.message.refusal?(s=t,i=e.message.content,(null==(o=s.response_format)?void 0:o.type)!=="json_schema"?null:(null==(a=s.response_format)?void 0:a.type)==="json_schema"?"$parseRaw"in s.response_format?s.response_format.$parseRaw(i):JSON.parse(i):null):null}}});return{...e,choices:n}}function ns(e){var t,n;return!!nt(e.response_format)||null!=(n=null==(t=e.tools)?void 0:t.some(e=>nn(e)||"function"===e.type&&!0===e.function.strict))&&n}function ni(e){for(let t of e||[])if("function"!==t.type)throw new eJ("Currently only `function` tool calls are supported; Received `".concat(t.type,"`"))}let no=e=>(null==e?void 0:e.role)==="assistant",na=e=>(null==e?void 0:e.role)==="tool";class nl{_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},eF(this,u,"m",x).bind(this))},0)}_connected(){this.ended||(eF(this,d,"f").call(this),this._emit("connect"))}get ended(){return eF(this,v,"f")}get errored(){return eF(this,w,"f")}get aborted(){return eF(this,b,"f")}abort(){this.controller.abort()}on(e,t){return(eF(this,y,"f")[e]||(eF(this,y,"f")[e]=[])).push({listener:t}),this}off(e,t){let n=eF(this,y,"f")[e];if(!n)return this;let r=n.findIndex(e=>e.listener===t);return r>=0&&n.splice(r,1),this}once(e,t){return(eF(this,y,"f")[e]||(eF(this,y,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,n)=>{eW(this,_,!0,"f"),"error"!==e&&this.once("error",n),this.once(e,t)})}async done(){eW(this,_,!0,"f"),await eF(this,p,"f")}_emit(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(eF(this,v,"f"))return;"end"===e&&(eW(this,v,!0,"f"),eF(this,m,"f").call(this));let s=eF(this,y,"f")[e];if(s&&(eF(this,y,"f")[e]=s.filter(e=>!e.once),s.forEach(e=>{let{listener:t}=e;return t(...n)})),"abort"===e){let e=n[0];eF(this,_,"f")||(null==s?void 0:s.length)||Promise.reject(e),eF(this,f,"f").call(this,e),eF(this,g,"f").call(this,e),this._emit("end");return}if("error"===e){let e=n[0];eF(this,_,"f")||(null==s?void 0:s.length)||Promise.reject(e),eF(this,f,"f").call(this,e),eF(this,g,"f").call(this,e),this._emit("end")}}_emitFinal(){}constructor(){u.add(this),this.controller=new AbortController,h.set(this,void 0),d.set(this,()=>{}),f.set(this,()=>{}),p.set(this,void 0),m.set(this,()=>{}),g.set(this,()=>{}),y.set(this,{}),v.set(this,!1),w.set(this,!1),b.set(this,!1),_.set(this,!1),eW(this,h,new Promise((e,t)=>{eW(this,d,e,"f"),eW(this,f,t,"f")}),"f"),eW(this,p,new Promise((e,t)=>{eW(this,m,e,"f"),eW(this,g,t,"f")}),"f"),eF(this,h,"f").catch(()=>{}),eF(this,p,"f").catch(()=>{})}}h=new WeakMap,d=new WeakMap,f=new WeakMap,p=new WeakMap,m=new WeakMap,g=new WeakMap,y=new WeakMap,v=new WeakMap,w=new WeakMap,b=new WeakMap,_=new WeakMap,u=new WeakSet,x=function(e){if(eW(this,w,!0,"f"),e instanceof Error&&"AbortError"===e.name&&(e=new eK),e instanceof eK)return eW(this,b,!0,"f"),this._emit("abort",e);if(e instanceof eJ)return this._emit("error",e);if(e instanceof Error){let t=new eJ(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new eJ(String(e)))};class nc extends nl{_addChatCompletion(e){var t;this._chatCompletions.push(e),this._emit("chatCompletion",e);let n=null==(t=e.choices[0])?void 0:t.message;return n&&this._addMessage(n),e}_addMessage(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),na(e)&&e.content)this._emit("functionToolCallResult",e.content);else if(no(e)&&e.tool_calls)for(let t of e.tool_calls)"function"===t.type&&this._emit("functionToolCall",t.function)}}async finalChatCompletion(){await this.done();let e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new eJ("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),eF(this,S,"m",A).call(this)}async finalMessage(){return await this.done(),eF(this,S,"m",j).call(this)}async finalFunctionToolCall(){return await this.done(),eF(this,S,"m",P).call(this)}async finalFunctionToolCallResult(){return await this.done(),eF(this,S,"m",I).call(this)}async totalUsage(){return await this.done(),eF(this,S,"m",R).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){let e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);let t=eF(this,S,"m",j).call(this);t&&this._emit("finalMessage",t);let n=eF(this,S,"m",A).call(this);n&&this._emit("finalContent",n);let r=eF(this,S,"m",P).call(this);r&&this._emit("finalFunctionToolCall",r);let s=eF(this,S,"m",I).call(this);null!=s&&this._emit("finalFunctionToolCallResult",s),this._chatCompletions.some(e=>e.usage)&&this._emit("totalUsage",eF(this,S,"m",R).call(this))}async _createChatCompletion(e,t,n){let r=null==n?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),eF(this,S,"m",E).call(this,t);let s=await e.chat.completions.create({...t,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(nr(s,t))}async _runChatCompletion(e,t,n){for(let e of t.messages)this._addMessage(e,!1);return await this._createChatCompletion(e,t,n)}async _runTools(e,t,n){var r,s,i;let o="tool",{tool_choice:a="auto",stream:l,...c}=t,u="string"!=typeof a&&"function"===a.type&&(null==a||null==(r=a.function)?void 0:r.name),{maxChatCompletions:h=10}=n||{},d=t.tools.map(e=>{if(nn(e)){if(!e.$callback)throw new eJ("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:e.$callback,name:e.function.name,description:e.function.description||"",parameters:e.function.parameters,parse:e.$parseRaw,strict:!0}}}return e}),f={};for(let e of d)"function"===e.type&&(f[e.function.name||e.function.function.name]=e.function);let p="tools"in t?d.map(e=>"function"===e.type?{type:"function",function:{name:e.function.name||e.function.function.name,parameters:e.function.parameters,description:e.function.description,strict:e.function.strict}}:e):void 0;for(let e of t.messages)this._addMessage(e,!1);for(let t=0;t<h;++t){let t=null==(s=(await this._createChatCompletion(e,{...c,tool_choice:a,tools:p,messages:[...this.messages]},n)).choices[0])?void 0:s.message;if(!t)throw new eJ("missing message in ChatCompletion response");if(!(null==(i=t.tool_calls)?void 0:i.length))break;for(let e of t.tool_calls){let t;if("function"!==e.type)continue;let n=e.id,{name:r,arguments:s}=e.function,i=f[r];if(i){if(u&&u!==r){let e="Invalid tool_call: ".concat(JSON.stringify(r),". ").concat(JSON.stringify(u)," requested. Please try again");this._addMessage({role:o,tool_call_id:n,content:e});continue}}else{let e="Invalid tool_call: ".concat(JSON.stringify(r),". Available options are: ").concat(Object.keys(f).map(e=>JSON.stringify(e)).join(", "),". Please try again");this._addMessage({role:o,tool_call_id:n,content:e});continue}try{t="function"==typeof i.parse?await i.parse(s):s}catch(t){let e=t instanceof Error?t.message:String(t);this._addMessage({role:o,tool_call_id:n,content:e});continue}let a=await i.function(t,this),l=eF(this,S,"m",O).call(this,a);if(this._addMessage({role:o,tool_call_id:n,content:l}),u)return}}}constructor(){super(...arguments),S.add(this),this._chatCompletions=[],this.messages=[]}}S=new WeakSet,A=function(){var e;return null!=(e=eF(this,S,"m",j).call(this).content)?e:null},j=function(){let e=this.messages.length;for(;e-- >0;){let r=this.messages[e];if(no(r)){var t,n;return{...r,content:null!=(t=r.content)?t:null,refusal:null!=(n=r.refusal)?n:null}}}throw new eJ("stream ended without producing a ChatCompletionMessage with role=assistant")},P=function(){for(let n=this.messages.length-1;n>=0;n--){var e,t;let r=this.messages[n];if(no(r)&&(null==r||null==(e=r.tool_calls)?void 0:e.length))return null==(t=r.tool_calls.filter(e=>"function"===e.type).at(-1))?void 0:t.function}},I=function(){for(let e=this.messages.length-1;e>=0;e--){let t=this.messages[e];if(na(t)&&null!=t.content&&"string"==typeof t.content&&this.messages.some(e=>{var n;return"assistant"===e.role&&(null==(n=e.tool_calls)?void 0:n.some(e=>"function"===e.type&&e.id===t.tool_call_id))}))return t.content}},R=function(){let e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(let{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},E=function(e){if(null!=e.n&&e.n>1)throw new eJ("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},O=function(e){return"string"==typeof e?e:void 0===e?"undefined":JSON.stringify(e)};class nu extends nc{static runTools(e,t,n){let r=new nu,s={...n,headers:{...null==n?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run(()=>r._runTools(e,t,s)),r}_addMessage(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];super._addMessage(e,t),no(e)&&e.content&&this._emit("content",e.content)}}let nh={STR:1,NUM:2,ARR:4,OBJ:8,NULL:16,BOOL:32,NAN:64,INFINITY:128,MINUS_INFINITY:256,INF:384,ALL:511};class nd extends Error{}class nf extends Error{}let np=e=>(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nh.ALL;if("string"!=typeof e)throw TypeError("expecting str, got ".concat(typeof e));if(!e.trim())throw Error("".concat(e," is empty"));return((e,t)=>{let n=e.length,r=0,s=e=>{throw new nd("".concat(e," at position ").concat(r))},i=e=>{throw new nf("".concat(e," at position ").concat(r))},o=()=>(h(),r>=n&&s("Unexpected end of input"),'"'===e[r])?a():"{"===e[r]?l():"["===e[r]?c():"null"===e.substring(r,r+4)||nh.NULL&t&&n-r<4&&"null".startsWith(e.substring(r))?(r+=4,null):"true"===e.substring(r,r+4)||nh.BOOL&t&&n-r<4&&"true".startsWith(e.substring(r))?(r+=4,!0):"false"===e.substring(r,r+5)||nh.BOOL&t&&n-r<5&&"false".startsWith(e.substring(r))?(r+=5,!1):"Infinity"===e.substring(r,r+8)||nh.INFINITY&t&&n-r<8&&"Infinity".startsWith(e.substring(r))?(r+=8,1/0):"-Infinity"===e.substring(r,r+9)||nh.MINUS_INFINITY&t&&1<n-r&&n-r<9&&"-Infinity".startsWith(e.substring(r))?(r+=9,-1/0):"NaN"===e.substring(r,r+3)||nh.NAN&t&&n-r<3&&"NaN".startsWith(e.substring(r))?(r+=3,NaN):u(),a=()=>{let o=r,a=!1;for(r++;r<n&&('"'!==e[r]||a&&"\\"===e[r-1]);)a="\\"===e[r]&&!a,r++;if('"'==e.charAt(r))try{return JSON.parse(e.substring(o,++r-Number(a)))}catch(e){i(String(e))}else if(nh.STR&t)try{return JSON.parse(e.substring(o,r-Number(a))+'"')}catch(t){return JSON.parse(e.substring(o,e.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},l=()=>{r++,h();let i={};try{for(;"}"!==e[r];){if(h(),r>=n&&nh.OBJ&t)return i;let s=a();h(),r++;try{let e=o();Object.defineProperty(i,s,{value:e,writable:!0,enumerable:!0,configurable:!0})}catch(e){if(nh.OBJ&t)return i;throw e}h(),","===e[r]&&r++}}catch(e){if(nh.OBJ&t)return i;s("Expected '}' at end of object")}return r++,i},c=()=>{r++;let n=[];try{for(;"]"!==e[r];)n.push(o()),h(),","===e[r]&&r++}catch(e){if(nh.ARR&t)return n;s("Expected ']' at end of array")}return r++,n},u=()=>{if(0===r){"-"===e&&nh.NUM&t&&s("Not sure what '-' is");try{return JSON.parse(e)}catch(n){if(nh.NUM&t)try{if("."===e[e.length-1])return JSON.parse(e.substring(0,e.lastIndexOf(".")));return JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch(e){}i(String(n))}}let o=r;for("-"===e[r]&&r++;e[r]&&!",]}".includes(e[r]);)r++;r!=n||nh.NUM&t||s("Unterminated number literal");try{return JSON.parse(e.substring(o,r))}catch(n){"-"===e.substring(o,r)&&nh.NUM&t&&s("Not sure what '-' is");try{return JSON.parse(e.substring(o,e.lastIndexOf("e")))}catch(e){i(String(e))}}},h=()=>{for(;r<n&&" \n\r	".includes(e[r]);)r++};return o()})(e.trim(),t)})(e,nh.ALL^nh.NUM);class nm extends nc{get currentChatCompletionSnapshot(){return eF(this,C,"f")}static fromReadableStream(e){let t=new nm(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,n){let r=new nm(t);return r._run(()=>r._runChatCompletion(e,{...t,stream:!0},{...n,headers:{...null==n?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createChatCompletion(e,t,n){var r;super._createChatCompletion;let s=null==n?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),eF(this,k,"m",B).call(this);let i=await e.chat.completions.create({...t,stream:!0},{...n,signal:this.controller.signal});for await(let e of(this._connected(),i))eF(this,k,"m",L).call(this,e);if(null==(r=i.controller.signal)?void 0:r.aborted)throw new eK;return this._addChatCompletion(eF(this,k,"m",W).call(this))}async _fromReadableStream(e,t){var n;let r,s=null==t?void 0:t.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),eF(this,k,"m",B).call(this),this._connected();let i=tN.fromReadableStream(e,this.controller);for await(let e of i)r&&r!==e.id&&this._addChatCompletion(eF(this,k,"m",W).call(this)),eF(this,k,"m",L).call(this,e),r=e.id;if(null==(n=i.controller.signal)?void 0:n.aborted)throw new eK;return this._addChatCompletion(eF(this,k,"m",W).call(this))}[(N=new WeakMap,T=new WeakMap,C=new WeakMap,k=new WeakSet,B=function(){this.ended||eW(this,C,void 0,"f")},M=function(e){let t=eF(this,T,"f")[e.index];return t||(t={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},eF(this,T,"f")[e.index]=t),t},L=function(e){if(this.ended)return;let t=eF(this,k,"m",q).call(this,e);for(let x of(this._emit("chunk",e,t),e.choices)){var n,r,s,i,o,a,l,c,u,h,d,f,p,m,g,y,v,w,b,_;let e=t.choices[x.index];null!=x.delta.content&&(null==(n=e.message)?void 0:n.role)==="assistant"&&(null==(r=e.message)?void 0:r.content)&&(this._emit("content",x.delta.content,e.message.content),this._emit("content.delta",{delta:x.delta.content,snapshot:e.message.content,parsed:e.message.parsed})),null!=x.delta.refusal&&(null==(s=e.message)?void 0:s.role)==="assistant"&&(null==(i=e.message)?void 0:i.refusal)&&this._emit("refusal.delta",{delta:x.delta.refusal,snapshot:e.message.refusal}),(null==(o=x.logprobs)?void 0:o.content)!=null&&(null==(a=e.message)?void 0:a.role)==="assistant"&&this._emit("logprobs.content.delta",{content:null==(u=x.logprobs)?void 0:u.content,snapshot:null!=(d=null==(h=e.logprobs)?void 0:h.content)?d:[]}),(null==(l=x.logprobs)?void 0:l.refusal)!=null&&(null==(c=e.message)?void 0:c.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:null==(f=x.logprobs)?void 0:f.refusal,snapshot:null!=(m=null==(p=e.logprobs)?void 0:p.refusal)?m:[]});let S=eF(this,k,"m",M).call(this,e);for(let t of(e.finish_reason&&(eF(this,k,"m",D).call(this,e),null!=S.current_tool_call_index&&eF(this,k,"m",U).call(this,e,S.current_tool_call_index)),null!=(g=x.delta.tool_calls)?g:[]))S.current_tool_call_index!==t.index&&(eF(this,k,"m",D).call(this,e),null!=S.current_tool_call_index&&eF(this,k,"m",U).call(this,e,S.current_tool_call_index)),S.current_tool_call_index=t.index;for(let t of null!=(y=x.delta.tool_calls)?y:[]){let n=null==(v=e.message.tool_calls)?void 0:v[t.index];(null==n?void 0:n.type)&&((null==n?void 0:n.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:null==(w=n.function)?void 0:w.name,index:t.index,arguments:n.function.arguments,parsed_arguments:n.function.parsed_arguments,arguments_delta:null!=(_=null==(b=t.function)?void 0:b.arguments)?_:""}):nv(null==n?void 0:n.type))}}},U=function(e,t){var n,r,s;if(eF(this,k,"m",M).call(this,e).done_tool_calls.has(t))return;let i=null==(n=e.message.tool_calls)?void 0:n[t];if(!i)throw Error("no tool call snapshot");if(!i.type)throw Error("tool call snapshot missing `type`");if("function"===i.type){let e=null==(s=eF(this,N,"f"))||null==(r=s.tools)?void 0:r.find(e=>ne(e)&&e.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:t,arguments:i.function.arguments,parsed_arguments:nn(e)?e.$parseRaw(i.function.arguments):(null==e?void 0:e.function.strict)?JSON.parse(i.function.arguments):null})}else nv(i.type)},D=function(e){var t,n;let r=eF(this,k,"m",M).call(this,e);if(e.message.content&&!r.content_done){r.content_done=!0;let t=eF(this,k,"m",F).call(this);this._emit("content.done",{content:e.message.content,parsed:t?t.$parseRaw(e.message.content):null})}e.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:e.message.refusal})),(null==(t=e.logprobs)?void 0:t.content)&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:e.logprobs.content})),(null==(n=e.logprobs)?void 0:n.refusal)&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:e.logprobs.refusal}))},W=function(){if(this.ended)throw new eJ("stream has ended, this shouldn't happen");let e=eF(this,C,"f");if(!e)throw new eJ("request ended without sending any chunks");return eW(this,C,void 0,"f"),eW(this,T,[],"f"),function(e,t){var n;let{id:r,choices:s,created:i,model:o,system_fingerprint:a,...l}=e;return n={...l,id:r,choices:s.map(t=>{var n,r,s;let{message:i,finish_reason:o,index:a,logprobs:l,...c}=t;if(!o)throw new eJ("missing finish_reason for choice ".concat(a));let{content:u=null,function_call:h,tool_calls:d,...f}=i,p=i.role;if(!p)throw new eJ("missing role for choice ".concat(a));if(h){let{arguments:e,name:t}=h;if(null==e)throw new eJ("missing function_call.arguments for choice ".concat(a));if(!t)throw new eJ("missing function_call.name for choice ".concat(a));return{...c,message:{content:u,function_call:{arguments:e,name:t},role:p,refusal:null!=(n=i.refusal)?n:null},finish_reason:o,index:a,logprobs:l}}return d?{...c,index:a,finish_reason:o,logprobs:l,message:{...f,role:p,content:u,refusal:null!=(r=i.refusal)?r:null,tool_calls:d.map((t,n)=>{let{function:r,type:s,id:i,...o}=t,{arguments:l,name:c,...u}=r||{};if(null==i)throw new eJ("missing choices[".concat(a,"].tool_calls[").concat(n,"].id\n").concat(ng(e)));if(null==s)throw new eJ("missing choices[".concat(a,"].tool_calls[").concat(n,"].type\n").concat(ng(e)));if(null==c)throw new eJ("missing choices[".concat(a,"].tool_calls[").concat(n,"].function.name\n").concat(ng(e)));if(null==l)throw new eJ("missing choices[".concat(a,"].tool_calls[").concat(n,"].function.arguments\n").concat(ng(e)));return{...o,id:i,type:s,function:{...u,name:c,arguments:l}}})}}:{...c,message:{...f,content:u,role:p,refusal:null!=(s=i.refusal)?s:null},finish_reason:o,index:a,logprobs:l}}),created:i,model:o,object:"chat.completion",...a?{system_fingerprint:a}:{}},t&&ns(t)?nr(n,t):{...n,choices:n.choices.map(e=>(ni(e.message.tool_calls),{...e,message:{...e.message,parsed:null,...e.message.tool_calls?{tool_calls:e.message.tool_calls}:void 0}}))}}(e,eF(this,N,"f"))},F=function(){var e;let t=null==(e=eF(this,N,"f"))?void 0:e.response_format;return nt(t)?t:null},q=function(e){var t,n,r,s,i,o;let a=eF(this,C,"f"),{choices:l,...c}=e;for(let{delta:l,finish_reason:u,index:h,logprobs:d=null,...f}of(a?Object.assign(a,c):a=eW(this,C,{...c,choices:[]},"f"),e.choices)){let e=a.choices[h];if(e||(e=a.choices[h]={finish_reason:u,index:h,message:{},logprobs:d,...f}),d)if(e.logprobs){let{content:r,refusal:s,...i}=d;ny(i),Object.assign(e.logprobs,i),r&&(null!=(t=e.logprobs).content||(t.content=[]),e.logprobs.content.push(...r)),s&&(null!=(n=e.logprobs).refusal||(n.refusal=[]),e.logprobs.refusal.push(...s))}else e.logprobs=Object.assign({},d);if(u&&(e.finish_reason=u,eF(this,N,"f")&&ns(eF(this,N,"f")))){if("length"===u)throw new e8;if("content_filter"===u)throw new e3}if(Object.assign(e,f),!l)continue;let{content:c,refusal:p,function_call:m,role:g,tool_calls:y,...v}=l;if(ny(v),Object.assign(e.message,v),p&&(e.message.refusal=(e.message.refusal||"")+p),g&&(e.message.role=g),m&&(e.message.function_call?(m.name&&(e.message.function_call.name=m.name),m.arguments&&(null!=(r=e.message.function_call).arguments||(r.arguments=""),e.message.function_call.arguments+=m.arguments)):e.message.function_call=m),c&&(e.message.content=(e.message.content||"")+c,!e.message.refusal&&eF(this,k,"m",F).call(this)&&(e.message.parsed=np(e.message.content))),y)for(let{index:t,id:n,type:r,function:a,...l}of(e.message.tool_calls||(e.message.tool_calls=[]),y)){let c=null!=(i=(s=e.message.tool_calls)[t])?i:s[t]={};Object.assign(c,l),n&&(c.id=n),r&&(c.type=r),a&&(null!=c.function||(c.function={name:null!=(o=a.name)?o:"",arguments:""})),(null==a?void 0:a.name)&&(c.function.name=a.name),(null==a?void 0:a.arguments)&&(c.function.arguments+=a.arguments,function(e,t){var n;if(!e||!("tools"in e)||!e.tools)return!1;let r=null==(n=e.tools)?void 0:n.find(e=>{var n;return ne(e)&&(null==(n=e.function)?void 0:n.name)===t.function.name});return ne(r)&&(nn(r)||(null==r?void 0:r.function.strict)||!1)}(eF(this,N,"f"),c)&&(c.function.parsed_arguments=np(c.function.arguments)))}}return a},Symbol.asyncIterator)](){let e=[],t=[],n=!1;return this.on("chunk",n=>{let r=t.shift();r?r.resolve(n):e.push(n)}),this.on("end",()=>{for(let e of(n=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let r of(n=!0,t))r.reject(e);t.length=0}),this.on("error",e=>{for(let r of(n=!0,t))r.reject(e);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((e,n)=>t.push({resolve:e,reject:n})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new tN(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}constructor(e){super(),k.add(this),N.set(this,void 0),T.set(this,void 0),C.set(this,void 0),eW(this,N,e,"f"),eW(this,T,[],"f")}}function ng(e){return JSON.stringify(e)}function ny(e){}function nv(e){}class nw extends nm{static fromReadableStream(e){let t=new nw(null);return t._run(()=>t._fromReadableStream(e)),t}static runTools(e,t,n){let r=new nw(t),s={...n,headers:{...null==n?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run(()=>r._runTools(e,t,s)),r}}function nb(){let e=t8(["/chat/completions/",""]);return nb=function(){return e},e}function n_(){let e=t8(["/chat/completions/",""]);return n_=function(){return e},e}function nx(){let e=t8(["/chat/completions/",""]);return nx=function(){return e},e}class nS extends t5{create(e,t){var n;return this._client.post("/chat/completions",{body:e,...t,stream:null!=(n=e.stream)&&n})}retrieve(e,t){return this._client.get(t4(nb(),e),t)}update(e,t,n){return this._client.post(t4(n_(),e),{body:t,...n})}list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return this._client.getAPIList("/chat/completions",tq,{query:e,...t})}delete(e,t){return this._client.delete(t4(nx(),e),t)}parse(e,t){var n=e.tools;for(let e of null!=n?n:[]){if("function"!==e.type)throw new eJ("Currently only `function` tool types support auto-parsing; Received `".concat(e.type,"`"));if(!0!==e.function.strict)throw new eJ("The `".concat(e.function.name,"` tool is not marked with `strict: true`. Only strict function tools can be auto-parsed"))}return this._client.chat.completions.create(e,{...t,headers:{...null==t?void 0:t.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(t=>nr(t,e))}runTools(e,t){return e.stream?nw.runTools(this._client,e,t):nu.runTools(this._client,e,t)}stream(e,t){return nm.createChatCompletion(this._client,e,t)}constructor(){super(...arguments),this.messages=new t9(this._client)}}nS.Messages=t9;class nA extends t5{constructor(){super(...arguments),this.completions=new nS(this._client)}}nA.Completions=nS;let nj=Symbol("brand.privateNullableHeaders"),nP=e=>{let t=new Headers,n=new Set;for(let r of e){let e=new Set;for(let[s,i]of function*(e){let t;if(!e)return;if(nj in e){let{values:t,nulls:n}=e;for(let e of(yield*t.entries(),n))yield[e,null];return}let n=!1;for(let r of(e instanceof Headers?t=e.entries():e9(e)?t=e:(n=!0,t=Object.entries(null!=e?e:{})),t)){let e=r[0];if("string"!=typeof e)throw TypeError("expected header name to be a string");let t=e9(r[1])?r[1]:[r[1]],s=!1;for(let r of t)void 0!==r&&(n&&!s&&(s=!0,yield[e,null]),yield[e,r])}}(r)){let r=s.toLowerCase();e.has(r)||(t.delete(s),e.add(r)),null===i?(t.delete(s),n.add(r)):(t.append(s,i),n.delete(r))}}return{[nj]:!0,values:t,nulls:n}};class nI extends t5{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:nP([{Accept:"application/octet-stream"},null==t?void 0:t.headers]),__binaryResponse:!0})}}class nR extends t5{create(e,t){var n;return this._client.post("/audio/transcriptions",tV({body:e,...t,stream:null!=(n=e.stream)&&n,__metadata:{model:e.model}},this._client))}}class nE extends t5{create(e,t){return this._client.post("/audio/translations",tV({body:e,...t,__metadata:{model:e.model}},this._client))}}class nO extends t5{constructor(){super(...arguments),this.transcriptions=new nR(this._client),this.translations=new nE(this._client),this.speech=new nI(this._client)}}function nk(){let e=t8(["/batches/",""]);return nk=function(){return e},e}function nN(){let e=t8(["/batches/","/cancel"]);return nN=function(){return e},e}nO.Transcriptions=nR,nO.Translations=nE,nO.Speech=nI;class nT extends t5{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(t4(nk(),e),t)}list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return this._client.getAPIList("/batches",tq,{query:e,...t})}cancel(e,t){return this._client.post(t4(nN(),e),t)}}function nC(){let e=t8(["/assistants/",""]);return nC=function(){return e},e}function nB(){let e=t8(["/assistants/",""]);return nB=function(){return e},e}function nM(){let e=t8(["/assistants/",""]);return nM=function(){return e},e}class nL extends t5{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==t?void 0:t.headers])})}retrieve(e,t){return this._client.get(t4(nC(),e),{...t,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==t?void 0:t.headers])})}update(e,t,n){return this._client.post(t4(nB(),e),{body:t,...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers])})}list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return this._client.getAPIList("/assistants",tq,{query:e,...t,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==t?void 0:t.headers])})}delete(e,t){return this._client.delete(t4(nM(),e),{...t,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==t?void 0:t.headers])})}}class nU extends t5{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==t?void 0:t.headers])})}}class nD extends t5{create(e,t){return this._client.post("/realtime/transcription_sessions",{body:e,...t,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==t?void 0:t.headers])})}}class nW extends t5{constructor(){super(...arguments),this.sessions=new nU(this._client),this.transcriptionSessions=new nD(this._client)}}function nF(){let e=t8(["/threads/","/messages"]);return nF=function(){return e},e}function nq(){let e=t8(["/threads/","/messages/",""]);return nq=function(){return e},e}function nX(){let e=t8(["/threads/","/messages/",""]);return nX=function(){return e},e}function nH(){let e=t8(["/threads/","/messages"]);return nH=function(){return e},e}function nJ(){let e=t8(["/threads/","/messages/",""]);return nJ=function(){return e},e}nW.Sessions=nU,nW.TranscriptionSessions=nD;class nz extends t5{create(e,t,n){return this._client.post(t4(nF(),e),{body:t,...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers])})}retrieve(e,t,n){let{thread_id:r}=t;return this._client.get(t4(nq(),r,e),{...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers])})}update(e,t,n){let{thread_id:r,...s}=t;return this._client.post(t4(nX(),r,e),{body:s,...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers])})}list(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return this._client.getAPIList(t4(nH(),e),tq,{query:t,...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers])})}delete(e,t,n){let{thread_id:r}=t;return this._client.delete(t4(nJ(),r,e),{...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers])})}}function nK(){let e=t8(["/threads/","/runs/","/steps/",""]);return nK=function(){return e},e}function nV(){let e=t8(["/threads/","/runs/","/steps"]);return nV=function(){return e},e}class nY extends t5{retrieve(e,t,n){let{thread_id:r,run_id:s,...i}=t;return this._client.get(t4(nK(),r,s,e),{query:i,...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers])})}list(e,t,n){let{thread_id:r,...s}=t;return this._client.getAPIList(t4(nV(),r,e),tq,{query:s,...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers])})}}var n$=e.i(67034);let nG=e=>{var t,n,r,s,i,o;return void 0!==globalThis.process?null!=(r=null==(n=globalThis.process.env)||null==(t=n[e])?void 0:t.trim())?r:void 0:void 0!==globalThis.Deno?null==(o=globalThis.Deno.env)||null==(i=o.get)||null==(s=i.call(o,e))?void 0:s.trim():void 0};class nQ extends nl{[(J=new WeakMap,z=new WeakMap,K=new WeakMap,V=new WeakMap,Y=new WeakMap,$=new WeakMap,G=new WeakMap,Q=new WeakMap,Z=new WeakMap,ee=new WeakMap,et=new WeakMap,en=new WeakMap,X=new WeakSet,Symbol.asyncIterator)](){let e=[],t=[],n=!1;return this.on("event",n=>{let r=t.shift();r?r.resolve(n):e.push(n)}),this.on("end",()=>{for(let e of(n=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let r of(n=!0,t))r.reject(e);t.length=0}),this.on("error",e=>{for(let r of(n=!0,t))r.reject(e);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((e,n)=>t.push({resolve:e,reject:n})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){let t=new H;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){var n;let r=null==t?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();let s=tN.fromReadableStream(e,this.controller);for await(let e of s)eF(this,X,"m",er).call(this,e);if(null==(n=s.controller.signal)?void 0:n.aborted)throw new eK;return this._addRun(eF(this,X,"m",es).call(this))}toReadableStream(){return new tN(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,n,r){let s=new H;return s._run(()=>s._runToolAssistantStream(e,t,n,{...r,headers:{...null==r?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createToolAssistantStream(e,t,n,r){var s;let i=null==r?void 0:r.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));let o={...n,stream:!0},a=await e.submitToolOutputs(t,o,{...r,signal:this.controller.signal});for await(let e of(this._connected(),a))eF(this,X,"m",er).call(this,e);if(null==(s=a.controller.signal)?void 0:s.aborted)throw new eK;return this._addRun(eF(this,X,"m",es).call(this))}static createThreadAssistantStream(e,t,n){let r=new H;return r._run(()=>r._threadAssistantStream(e,t,{...n,headers:{...null==n?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),r}static createAssistantStream(e,t,n,r){let s=new H;return s._run(()=>s._runAssistantStream(e,t,n,{...r,headers:{...null==r?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}currentEvent(){return eF(this,ee,"f")}currentRun(){return eF(this,et,"f")}currentMessageSnapshot(){return eF(this,V,"f")}currentRunStepSnapshot(){return eF(this,en,"f")}async finalRunSteps(){return await this.done(),Object.values(eF(this,z,"f"))}async finalMessages(){return await this.done(),Object.values(eF(this,K,"f"))}async finalRun(){if(await this.done(),!eF(this,Y,"f"))throw Error("Final run was not received.");return eF(this,Y,"f")}async _createThreadAssistantStream(e,t,n){var r;let s=null==n?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));let i={...t,stream:!0},o=await e.createAndRun(i,{...n,signal:this.controller.signal});for await(let e of(this._connected(),o))eF(this,X,"m",er).call(this,e);if(null==(r=o.controller.signal)?void 0:r.aborted)throw new eK;return this._addRun(eF(this,X,"m",es).call(this))}async _createAssistantStream(e,t,n,r){var s;let i=null==r?void 0:r.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));let o={...n,stream:!0},a=await e.create(t,o,{...r,signal:this.controller.signal});for await(let e of(this._connected(),a))eF(this,X,"m",er).call(this,e);if(null==(s=a.controller.signal)?void 0:s.aborted)throw new eK;return this._addRun(eF(this,X,"m",es).call(this))}static accumulateDelta(e,t){for(let[n,r]of Object.entries(t)){if(!e.hasOwnProperty(n)){e[n]=r;continue}let t=e[n];if(null==t||"index"===n||"type"===n){e[n]=r;continue}if("string"==typeof t&&"string"==typeof r)t+=r;else if("number"==typeof t&&"number"==typeof r)t+=r;else if(tt(t)&&tt(r))t=this.accumulateDelta(t,r);else if(Array.isArray(t)&&Array.isArray(r)){if(t.every(e=>"string"==typeof e||"number"==typeof e)){t.push(...r);continue}for(let e of r){if(!tt(e))throw Error("Expected array delta entry to be an object but got: ".concat(e));let n=e.index;if(null==n)throw console.error(e),Error("Expected array delta entry to have an `index` property");if("number"!=typeof n)throw Error("Expected array delta entry `index` property to be a number but got ".concat(n));let r=t[n];null==r?t.push(e):t[n]=this.accumulateDelta(r,e)}continue}else throw Error("Unhandled record type: ".concat(n,", deltaValue: ").concat(r,", accValue: ").concat(t));e[n]=t}return e}_addRun(e){return e}async _threadAssistantStream(e,t,n){return await this._createThreadAssistantStream(t,e,n)}async _runAssistantStream(e,t,n,r){return await this._createAssistantStream(t,e,n,r)}async _runToolAssistantStream(e,t,n,r){return await this._createToolAssistantStream(t,e,n,r)}constructor(){super(...arguments),X.add(this),J.set(this,[]),z.set(this,{}),K.set(this,{}),V.set(this,void 0),Y.set(this,void 0),$.set(this,void 0),G.set(this,void 0),Q.set(this,void 0),Z.set(this,void 0),ee.set(this,void 0),et.set(this,void 0),en.set(this,void 0)}}function nZ(){let e=t8(["/threads/","/runs"]);return nZ=function(){return e},e}function n0(){let e=t8(["/threads/","/runs/",""]);return n0=function(){return e},e}function n1(){let e=t8(["/threads/","/runs/",""]);return n1=function(){return e},e}function n2(){let e=t8(["/threads/","/runs"]);return n2=function(){return e},e}function n5(){let e=t8(["/threads/","/runs/","/cancel"]);return n5=function(){return e},e}function n8(){let e=t8(["/threads/","/runs/","/submit_tool_outputs"]);return n8=function(){return e},e}H=nQ,er=function(e){if(!this.ended)switch(eW(this,ee,e,"f"),eF(this,X,"m",ea).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":eF(this,X,"m",eh).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":eF(this,X,"m",eo).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":eF(this,X,"m",ei).call(this,e);break;case"error":throw Error("Encountered an error event in event processing - errors should be processed earlier")}},es=function(){if(this.ended)throw new eJ("stream has ended, this shouldn't happen");if(!eF(this,Y,"f"))throw Error("Final run has not been received");return eF(this,Y,"f")},ei=function(e){let[t,n]=eF(this,X,"m",ec).call(this,e,eF(this,V,"f"));for(let e of(eW(this,V,t,"f"),eF(this,K,"f")[t.id]=t,n)){let n=t.content[e.index];(null==n?void 0:n.type)=="text"&&this._emit("textCreated",n.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(let n of e.data.delta.content){if("text"==n.type&&n.text){let e=n.text,r=t.content[n.index];if(r&&"text"==r.type)this._emit("textDelta",e,r.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(n.index!=eF(this,$,"f")){if(eF(this,G,"f"))switch(eF(this,G,"f").type){case"text":this._emit("textDone",eF(this,G,"f").text,eF(this,V,"f"));break;case"image_file":this._emit("imageFileDone",eF(this,G,"f").image_file,eF(this,V,"f"))}eW(this,$,n.index,"f")}eW(this,G,t.content[n.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(void 0!==eF(this,$,"f")){let t=e.data.content[eF(this,$,"f")];if(t)switch(t.type){case"image_file":this._emit("imageFileDone",t.image_file,eF(this,V,"f"));break;case"text":this._emit("textDone",t.text,eF(this,V,"f"))}}eF(this,V,"f")&&this._emit("messageDone",e.data),eW(this,V,void 0,"f")}},eo=function(e){let t=eF(this,X,"m",el).call(this,e);switch(eW(this,en,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":let n=e.data.delta;if(n.step_details&&"tool_calls"==n.step_details.type&&n.step_details.tool_calls&&"tool_calls"==t.step_details.type)for(let e of n.step_details.tool_calls)e.index==eF(this,Q,"f")?this._emit("toolCallDelta",e,t.step_details.tool_calls[e.index]):(eF(this,Z,"f")&&this._emit("toolCallDone",eF(this,Z,"f")),eW(this,Q,e.index,"f"),eW(this,Z,t.step_details.tool_calls[e.index],"f"),eF(this,Z,"f")&&this._emit("toolCallCreated",eF(this,Z,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":eW(this,en,void 0,"f"),"tool_calls"==e.data.step_details.type&&eF(this,Z,"f")&&(this._emit("toolCallDone",eF(this,Z,"f")),eW(this,Z,void 0,"f")),this._emit("runStepDone",e.data,t)}},ea=function(e){eF(this,J,"f").push(e),this._emit("event",e)},el=function(e){switch(e.event){case"thread.run.step.created":return eF(this,z,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=eF(this,z,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){let r=H.accumulateDelta(t,n.delta);eF(this,z,"f")[e.data.id]=r}return eF(this,z,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":eF(this,z,"f")[e.data.id]=e.data}if(eF(this,z,"f")[e.data.id])return eF(this,z,"f")[e.data.id];throw Error("No snapshot available")},ec=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=e.data;if(r.delta.content)for(let e of r.delta.content)if(e.index in t.content){let n=t.content[e.index];t.content[e.index]=eF(this,X,"m",eu).call(this,e,n)}else t.content[e.index]=e,n.push(e);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},eu=function(e,t){return H.accumulateDelta(t,e)},eh=function(e){switch(eW(this,et,e.data,"f"),e.event){case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":eW(this,Y,e.data,"f"),eF(this,Z,"f")&&(this._emit("toolCallDone",eF(this,Z,"f")),eW(this,Z,void 0,"f"))}};class n3 extends t5{create(e,t,n){var r;let{include:s,...i}=t;return this._client.post(t4(nZ(),e),{query:{include:s},body:i,...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers]),stream:null!=(r=t.stream)&&r})}retrieve(e,t,n){let{thread_id:r}=t;return this._client.get(t4(n0(),r,e),{...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers])})}update(e,t,n){let{thread_id:r,...s}=t;return this._client.post(t4(n1(),r,e),{body:s,...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers])})}list(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return this._client.getAPIList(t4(n2(),e),tq,{query:t,...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers])})}cancel(e,t,n){let{thread_id:r}=t;return this._client.post(t4(n5(),r,e),{...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers])})}async createAndPoll(e,t,n){let r=await this.create(e,t,n);return await this.poll(r.id,{thread_id:e},n)}createAndStream(e,t,n){return nQ.createAssistantStream(e,this._client.beta.threads.runs,t,n)}async poll(e,t,n){var r,s;let i=nP([null==n?void 0:n.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":null!=(s=null==n||null==(r=n.pollIntervalMs)?void 0:r.toString())?s:void 0}]);for(;;){let{data:r,response:s}=await this.retrieve(e,t,{...n,headers:{...null==n?void 0:n.headers,...i}}).withResponse();switch(r.status){case"queued":case"in_progress":case"cancelling":let o=5e3;if(null==n?void 0:n.pollIntervalMs)o=n.pollIntervalMs;else{let e=s.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(o=t)}}await tn(o);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return r}}}stream(e,t,n){return nQ.createAssistantStream(e,this._client.beta.threads.runs,t,n)}submitToolOutputs(e,t,n){var r;let{thread_id:s,...i}=t;return this._client.post(t4(n8(),s,e),{body:i,...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers]),stream:null!=(r=t.stream)&&r})}async submitToolOutputsAndPoll(e,t,n){let r=await this.submitToolOutputs(e,t,n);return await this.poll(r.id,t,n)}submitToolOutputsStream(e,t,n){return nQ.createToolAssistantStream(e,this._client.beta.threads.runs,t,n)}constructor(){super(...arguments),this.steps=new nY(this._client)}}function n6(){let e=t8(["/threads/",""]);return n6=function(){return e},e}function n4(){let e=t8(["/threads/",""]);return n4=function(){return e},e}function n7(){let e=t8(["/threads/",""]);return n7=function(){return e},e}n3.Steps=nY;class n9 extends t5{create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return this._client.post("/threads",{body:e,...t,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==t?void 0:t.headers])})}retrieve(e,t){return this._client.get(t4(n6(),e),{...t,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==t?void 0:t.headers])})}update(e,t,n){return this._client.post(t4(n4(),e),{body:t,...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers])})}delete(e,t){return this._client.delete(t4(n7(),e),{...t,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==t?void 0:t.headers])})}createAndRun(e,t){var n;return this._client.post("/threads/runs",{body:e,...t,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==t?void 0:t.headers]),stream:null!=(n=e.stream)&&n})}async createAndRunPoll(e,t){let n=await this.createAndRun(e,t);return await this.runs.poll(n.id,{thread_id:n.thread_id},t)}createAndRunStream(e,t){return nQ.createThreadAssistantStream(e,this._client.beta.threads,t)}constructor(){super(...arguments),this.runs=new n3(this._client),this.messages=new nz(this._client)}}n9.Runs=n3,n9.Messages=nz;class re extends t5{constructor(){super(...arguments),this.realtime=new nW(this._client),this.assistants=new nL(this._client),this.threads=new n9(this._client)}}re.Realtime=nW,re.Assistants=nL,re.Threads=n9;class rt extends t5{create(e,t){var n;return this._client.post("/completions",{body:e,...t,stream:null!=(n=e.stream)&&n})}}function rn(){let e=t8(["/containers/","/files/","/content"]);return rn=function(){return e},e}class rr extends t5{retrieve(e,t,n){let{container_id:r}=t;return this._client.get(t4(rn(),r,e),{...n,headers:nP([{Accept:"application/binary"},null==n?void 0:n.headers]),__binaryResponse:!0})}}function rs(){let e=t8(["/containers/","/files"]);return rs=function(){return e},e}function ri(){let e=t8(["/containers/","/files/",""]);return ri=function(){return e},e}function ro(){let e=t8(["/containers/","/files"]);return ro=function(){return e},e}function ra(){let e=t8(["/containers/","/files/",""]);return ra=function(){return e},e}class rl extends t5{create(e,t,n){return this._client.post(t4(rs(),e),tV({body:t,...n},this._client))}retrieve(e,t,n){let{container_id:r}=t;return this._client.get(t4(ri(),r,e),n)}list(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return this._client.getAPIList(t4(ro(),e),tq,{query:t,...n})}delete(e,t,n){let{container_id:r}=t;return this._client.delete(t4(ra(),r,e),{...n,headers:nP([{Accept:"*/*"},null==n?void 0:n.headers])})}constructor(){super(...arguments),this.content=new rr(this._client)}}function rc(){let e=t8(["/containers/",""]);return rc=function(){return e},e}function ru(){let e=t8(["/containers/",""]);return ru=function(){return e},e}rl.Content=rr;class rh extends t5{create(e,t){return this._client.post("/containers",{body:e,...t})}retrieve(e,t){return this._client.get(t4(rc(),e),t)}list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return this._client.getAPIList("/containers",tq,{query:e,...t})}delete(e,t){return this._client.delete(t4(ru(),e),{...t,headers:nP([{Accept:"*/*"},null==t?void 0:t.headers])})}constructor(){super(...arguments),this.files=new rl(this._client)}}function rd(){let e=t8(["/conversations/","/items"]);return rd=function(){return e},e}function rf(){let e=t8(["/conversations/","/items/",""]);return rf=function(){return e},e}function rp(){let e=t8(["/conversations/","/items"]);return rp=function(){return e},e}function rm(){let e=t8(["/conversations/","/items/",""]);return rm=function(){return e},e}rh.Files=rl;class rg extends t5{create(e,t,n){let{include:r,...s}=t;return this._client.post(t4(rd(),e),{query:{include:r},body:s,...n})}retrieve(e,t,n){let{conversation_id:r,...s}=t;return this._client.get(t4(rf(),r,e),{query:s,...n})}list(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return this._client.getAPIList(t4(rp(),e),tX,{query:t,...n})}delete(e,t,n){let{conversation_id:r}=t;return this._client.delete(t4(rm(),r,e),n)}}function ry(){let e=t8(["/conversations/",""]);return ry=function(){return e},e}function rv(){let e=t8(["/conversations/",""]);return rv=function(){return e},e}function rw(){let e=t8(["/conversations/",""]);return rw=function(){return e},e}class rb extends t5{create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return this._client.post("/conversations",{body:e,...t})}retrieve(e,t){return this._client.get(t4(ry(),e),t)}update(e,t,n){return this._client.post(t4(rv(),e),{body:t,...n})}delete(e,t){return this._client.delete(t4(rw(),e),t)}constructor(){super(...arguments),this.items=new rg(this._client)}}rb.Items=rg;class r_ extends t5{create(e,t){let n=!!e.encoding_format,r=n?e.encoding_format:"base64";n&&tO(this._client).debug("embeddings/user defined encoding_format:",e.encoding_format);let s=this._client.post("/embeddings",{body:{...e,encoding_format:r},...t});return n?s:(tO(this._client).debug("embeddings/decoding base64 embeddings from base64"),s._thenUnwrap(e=>(e&&e.data&&e.data.forEach(e=>{let t=e.embedding;e.embedding=(e=>{if(void 0!==n$.Buffer){let t=n$.Buffer.from(e,"base64");return Array.from(new Float32Array(t.buffer,t.byteOffset,t.length/Float32Array.BYTES_PER_ELEMENT))}{let t=atob(e),n=t.length,r=new Uint8Array(n);for(let e=0;e<n;e++)r[e]=t.charCodeAt(e);return Array.from(new Float32Array(r.buffer))}})(t)}),e)))}}function rx(){let e=t8(["/evals/","/runs/","/output_items/",""]);return rx=function(){return e},e}function rS(){let e=t8(["/evals/","/runs/","/output_items"]);return rS=function(){return e},e}class rA extends t5{retrieve(e,t,n){let{eval_id:r,run_id:s}=t;return this._client.get(t4(rx(),r,s,e),n)}list(e,t,n){let{eval_id:r,...s}=t;return this._client.getAPIList(t4(rS(),r,e),tq,{query:s,...n})}}function rj(){let e=t8(["/evals/","/runs"]);return rj=function(){return e},e}function rP(){let e=t8(["/evals/","/runs/",""]);return rP=function(){return e},e}function rI(){let e=t8(["/evals/","/runs"]);return rI=function(){return e},e}function rR(){let e=t8(["/evals/","/runs/",""]);return rR=function(){return e},e}function rE(){let e=t8(["/evals/","/runs/",""]);return rE=function(){return e},e}class rO extends t5{create(e,t,n){return this._client.post(t4(rj(),e),{body:t,...n})}retrieve(e,t,n){let{eval_id:r}=t;return this._client.get(t4(rP(),r,e),n)}list(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return this._client.getAPIList(t4(rI(),e),tq,{query:t,...n})}delete(e,t,n){let{eval_id:r}=t;return this._client.delete(t4(rR(),r,e),n)}cancel(e,t,n){let{eval_id:r}=t;return this._client.post(t4(rE(),r,e),n)}constructor(){super(...arguments),this.outputItems=new rA(this._client)}}function rk(){let e=t8(["/evals/",""]);return rk=function(){return e},e}function rN(){let e=t8(["/evals/",""]);return rN=function(){return e},e}function rT(){let e=t8(["/evals/",""]);return rT=function(){return e},e}rO.OutputItems=rA;class rC extends t5{create(e,t){return this._client.post("/evals",{body:e,...t})}retrieve(e,t){return this._client.get(t4(rk(),e),t)}update(e,t,n){return this._client.post(t4(rN(),e),{body:t,...n})}list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return this._client.getAPIList("/evals",tq,{query:e,...t})}delete(e,t){return this._client.delete(t4(rT(),e),t)}constructor(){super(...arguments),this.runs=new rO(this._client)}}function rB(){let e=t8(["/files/",""]);return rB=function(){return e},e}function rM(){let e=t8(["/files/",""]);return rM=function(){return e},e}function rL(){let e=t8(["/files/","/content"]);return rL=function(){return e},e}rC.Runs=rO;class rU extends t5{create(e,t){return this._client.post("/files",tV({body:e,...t},this._client))}retrieve(e,t){return this._client.get(t4(rB(),e),t)}list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return this._client.getAPIList("/files",tq,{query:e,...t})}delete(e,t){return this._client.delete(t4(rM(),e),t)}content(e,t){return this._client.get(t4(rL(),e),{...t,headers:nP([{Accept:"application/binary"},null==t?void 0:t.headers]),__binaryResponse:!0})}async waitForProcessing(e){let{pollInterval:t=5e3,maxWait:n=18e5}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new Set(["processed","error","deleted"]),s=Date.now(),i=await this.retrieve(e);for(;!i.status||!r.has(i.status);)if(await tn(t),i=await this.retrieve(e),Date.now()-s>n)throw new eY({message:"Giving up on waiting for file ".concat(e," to finish processing after ").concat(n," milliseconds.")});return i}}class rD extends t5{}class rW extends t5{run(e,t){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...t})}validate(e,t){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...t})}}class rF extends t5{constructor(){super(...arguments),this.graders=new rW(this._client)}}function rq(){let e=t8(["/fine_tuning/checkpoints/","/permissions"]);return rq=function(){return e},e}function rX(){let e=t8(["/fine_tuning/checkpoints/","/permissions"]);return rX=function(){return e},e}function rH(){let e=t8(["/fine_tuning/checkpoints/","/permissions/",""]);return rH=function(){return e},e}rF.Graders=rW;class rJ extends t5{create(e,t,n){return this._client.getAPIList(t4(rq(),e),tF,{body:t,method:"post",...n})}retrieve(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return this._client.get(t4(rX(),e),{query:t,...n})}delete(e,t,n){let{fine_tuned_model_checkpoint:r}=t;return this._client.delete(t4(rH(),r,e),n)}}class rz extends t5{constructor(){super(...arguments),this.permissions=new rJ(this._client)}}function rK(){let e=t8(["/fine_tuning/jobs/","/checkpoints"]);return rK=function(){return e},e}rz.Permissions=rJ;class rV extends t5{list(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return this._client.getAPIList(t4(rK(),e),tq,{query:t,...n})}}function rY(){let e=t8(["/fine_tuning/jobs/",""]);return rY=function(){return e},e}function r$(){let e=t8(["/fine_tuning/jobs/","/cancel"]);return r$=function(){return e},e}function rG(){let e=t8(["/fine_tuning/jobs/","/events"]);return rG=function(){return e},e}function rQ(){let e=t8(["/fine_tuning/jobs/","/pause"]);return rQ=function(){return e},e}function rZ(){let e=t8(["/fine_tuning/jobs/","/resume"]);return rZ=function(){return e},e}class r0 extends t5{create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(t4(rY(),e),t)}list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return this._client.getAPIList("/fine_tuning/jobs",tq,{query:e,...t})}cancel(e,t){return this._client.post(t4(r$(),e),t)}listEvents(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return this._client.getAPIList(t4(rG(),e),tq,{query:t,...n})}pause(e,t){return this._client.post(t4(rQ(),e),t)}resume(e,t){return this._client.post(t4(rZ(),e),t)}constructor(){super(...arguments),this.checkpoints=new rV(this._client)}}r0.Checkpoints=rV;class r1 extends t5{constructor(){super(...arguments),this.methods=new rD(this._client),this.jobs=new r0(this._client),this.checkpoints=new rz(this._client),this.alpha=new rF(this._client)}}r1.Methods=rD,r1.Jobs=r0,r1.Checkpoints=rz,r1.Alpha=rF;class r2 extends t5{}class r5 extends t5{constructor(){super(...arguments),this.graderModels=new r2(this._client)}}r5.GraderModels=r2;class r8 extends t5{createVariation(e,t){return this._client.post("/images/variations",tV({body:e,...t},this._client))}edit(e,t){var n;return this._client.post("/images/edits",tV({body:e,...t,stream:null!=(n=e.stream)&&n},this._client))}generate(e,t){var n;return this._client.post("/images/generations",{body:e,...t,stream:null!=(n=e.stream)&&n})}}function r3(){let e=t8(["/models/",""]);return r3=function(){return e},e}function r6(){let e=t8(["/models/",""]);return r6=function(){return e},e}class r4 extends t5{retrieve(e,t){return this._client.get(t4(r3(),e),t)}list(e){return this._client.getAPIList("/models",tF,e)}delete(e,t){return this._client.delete(t4(r6(),e),t)}}class r7 extends t5{create(e,t){return this._client.post("/moderations",{body:e,...t})}}class r9 extends t5{create(e,t){return this._client.post("/realtime/client_secrets",{body:e,...t})}}class se extends t5{constructor(){super(...arguments),this.clientSecrets=new r9(this._client)}}function st(e,t){let n=e.output.map(e=>{if("function_call"===e.type)return{...e,parsed_arguments:function(e,t){var n,r,s;let i=(r=null!=(n=e.tools)?n:[],s=t.name,r.find(e=>"function"===e.type&&e.name===s));return{...t,...t,parsed_arguments:(null==i?void 0:i.$brand)==="auto-parseable-tool"?i.$parseRaw(t.arguments):(null==i?void 0:i.strict)?JSON.parse(t.arguments):null}}(t,e)};if("message"===e.type){let n=e.content.map(e=>{var n,r,s,i,o,a;return"output_text"===e.type?{...e,parsed:(n=t,r=e.text,(null==(i=n.text)||null==(s=i.format)?void 0:s.type)!=="json_schema"?null:"$parseRaw"in(null==(o=n.text)?void 0:o.format)?(null==(a=n.text)?void 0:a.format).$parseRaw(r):JSON.parse(r))}:e});return{...e,content:n}}return e}),r=Object.assign({},e,{output:n});return Object.getOwnPropertyDescriptor(e,"output_text")||sn(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(let e of r.output)if("message"===e.type){for(let t of e.content)if("output_text"===t.type&&null!==t.parsed)return t.parsed}return null}}),r}function sn(e){let t=[];for(let n of e.output)if("message"===n.type)for(let e of n.content)"output_text"===e.type&&t.push(e.text);e.output_text=t.join("")}se.ClientSecrets=r9;class sr extends nl{static createResponse(e,t,n){let r=new sr(t);return r._run(()=>r._createOrRetrieveResponse(e,t,{...n,headers:{...null==n?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createOrRetrieveResponse(e,t,n){var r,s;let i,o=null==n?void 0:n.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort())),eF(this,ed,"m",eg).call(this);let a=null;for await(let r of("response_id"in t?(i=await e.responses.retrieve(t.response_id,{stream:!0},{...n,signal:this.controller.signal,stream:!0}),a=null!=(s=t.starting_after)?s:null):i=await e.responses.create({...t,stream:!0},{...n,signal:this.controller.signal}),this._connected(),i))eF(this,ed,"m",ey).call(this,r,a);if(null==(r=i.controller.signal)?void 0:r.aborted)throw new eK;return eF(this,ed,"m",ev).call(this)}[(ef=new WeakMap,ep=new WeakMap,em=new WeakMap,ed=new WeakSet,eg=function(){this.ended||eW(this,ep,void 0,"f")},ey=function(e,t){if(this.ended)return;let n=(e,n)=>{(null==t||n.sequence_number>t)&&this._emit(e,n)},r=eF(this,ed,"m",ew).call(this,e);switch(n("event",e),e.type){case"response.output_text.delta":{let t=r.output[e.output_index];if(!t)throw new eJ("missing output at index ".concat(e.output_index));if("message"===t.type){let r=t.content[e.content_index];if(!r)throw new eJ("missing content at index ".concat(e.content_index));if("output_text"!==r.type)throw new eJ("expected content to be 'output_text', got ".concat(r.type));n("response.output_text.delta",{...e,snapshot:r.text})}break}case"response.function_call_arguments.delta":{let t=r.output[e.output_index];if(!t)throw new eJ("missing output at index ".concat(e.output_index));"function_call"===t.type&&n("response.function_call_arguments.delta",{...e,snapshot:t.arguments});break}default:n(e.type,e)}},ev=function(){if(this.ended)throw new eJ("stream has ended, this shouldn't happen");let e=eF(this,ep,"f");if(!e)throw new eJ("request ended without sending any events");eW(this,ep,void 0,"f");let t=function(e,t){var n;return t&&nt(null==(n=t.text)?void 0:n.format)?st(e,t):{...e,output_parsed:null,output:e.output.map(e=>"function_call"===e.type?{...e,parsed_arguments:null}:"message"===e.type?{...e,content:e.content.map(e=>({...e,parsed:null}))}:e)}}(e,eF(this,ef,"f"));return eW(this,em,t,"f"),t},ew=function(e){let t=eF(this,ep,"f");if(!t){if("response.created"!==e.type)throw new eJ("When snapshot hasn't been set yet, expected 'response.created' event, got ".concat(e.type));return eW(this,ep,e.response,"f")}switch(e.type){case"response.output_item.added":t.output.push(e.item);break;case"response.content_part.added":{let n=t.output[e.output_index];if(!n)throw new eJ("missing output at index ".concat(e.output_index));let r=n.type,s=e.part;"message"===r&&"reasoning_text"!==s.type?n.content.push(s):"reasoning"===r&&"reasoning_text"===s.type&&(n.content||(n.content=[]),n.content.push(s));break}case"response.output_text.delta":{let n=t.output[e.output_index];if(!n)throw new eJ("missing output at index ".concat(e.output_index));if("message"===n.type){let t=n.content[e.content_index];if(!t)throw new eJ("missing content at index ".concat(e.content_index));if("output_text"!==t.type)throw new eJ("expected content to be 'output_text', got ".concat(t.type));t.text+=e.delta}break}case"response.function_call_arguments.delta":{let n=t.output[e.output_index];if(!n)throw new eJ("missing output at index ".concat(e.output_index));"function_call"===n.type&&(n.arguments+=e.delta);break}case"response.reasoning_text.delta":{let r=t.output[e.output_index];if(!r)throw new eJ("missing output at index ".concat(e.output_index));if("reasoning"===r.type){var n;let t=null==(n=r.content)?void 0:n[e.content_index];if(!t)throw new eJ("missing content at index ".concat(e.content_index));if("reasoning_text"!==t.type)throw new eJ("expected content to be 'reasoning_text', got ".concat(t.type));t.text+=e.delta}break}case"response.completed":eW(this,ep,e.response,"f")}return t},Symbol.asyncIterator)](){let e=[],t=[],n=!1;return this.on("event",n=>{let r=t.shift();r?r.resolve(n):e.push(n)}),this.on("end",()=>{for(let e of(n=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let r of(n=!0,t))r.reject(e);t.length=0}),this.on("error",e=>{for(let r of(n=!0,t))r.reject(e);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((e,n)=>t.push({resolve:e,reject:n})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();let e=eF(this,em,"f");if(!e)throw new eJ("stream ended without producing a ChatCompletion");return e}constructor(e){super(),ed.add(this),ef.set(this,void 0),ep.set(this,void 0),em.set(this,void 0),eW(this,ef,e,"f")}}function ss(){let e=t8(["/responses/","/input_items"]);return ss=function(){return e},e}class si extends t5{list(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return this._client.getAPIList(t4(ss(),e),tq,{query:t,...n})}}function so(){let e=t8(["/responses/",""]);return so=function(){return e},e}function sa(){let e=t8(["/responses/",""]);return sa=function(){return e},e}function sl(){let e=t8(["/responses/","/cancel"]);return sl=function(){return e},e}class sc extends t5{create(e,t){var n;return this._client.post("/responses",{body:e,...t,stream:null!=(n=e.stream)&&n})._thenUnwrap(e=>("object"in e&&"response"===e.object&&sn(e),e))}retrieve(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return this._client.get(t4(so(),e),{query:n,...r,stream:null!=(t=null==n?void 0:n.stream)&&t})._thenUnwrap(e=>("object"in e&&"response"===e.object&&sn(e),e))}delete(e,t){return this._client.delete(t4(sa(),e),{...t,headers:nP([{Accept:"*/*"},null==t?void 0:t.headers])})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap(t=>st(t,e))}stream(e,t){return sr.createResponse(this._client,e,t)}cancel(e,t){return this._client.post(t4(sl(),e),t)}constructor(){super(...arguments),this.inputItems=new si(this._client)}}function su(){let e=t8(["/uploads/","/parts"]);return su=function(){return e},e}sc.InputItems=si;class sh extends t5{create(e,t,n){return this._client.post(t4(su(),e),tV({body:t,...n},this._client))}}function sd(){let e=t8(["/uploads/","/cancel"]);return sd=function(){return e},e}function sf(){let e=t8(["/uploads/","/complete"]);return sf=function(){return e},e}class sp extends t5{create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(t4(sd(),e),t)}complete(e,t,n){return this._client.post(t4(sf(),e),{body:t,...n})}constructor(){super(...arguments),this.parts=new sh(this._client)}}sp.Parts=sh;let sm=async e=>{let t=await Promise.allSettled(e),n=t.filter(e=>"rejected"===e.status);if(n.length){for(let e of n)console.error(e.reason);throw Error("".concat(n.length," promise(s) failed - see the above errors"))}let r=[];for(let e of t)"fulfilled"===e.status&&r.push(e.value);return r};function sg(){let e=t8(["/vector_stores/","/file_batches"]);return sg=function(){return e},e}function sy(){let e=t8(["/vector_stores/","/file_batches/",""]);return sy=function(){return e},e}function sv(){let e=t8(["/vector_stores/","/file_batches/","/cancel"]);return sv=function(){return e},e}function sw(){let e=t8(["/vector_stores/","/file_batches/","/files"]);return sw=function(){return e},e}class sb extends t5{create(e,t,n){return this._client.post(t4(sg(),e),{body:t,...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers])})}retrieve(e,t,n){let{vector_store_id:r}=t;return this._client.get(t4(sy(),r,e),{...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers])})}cancel(e,t,n){let{vector_store_id:r}=t;return this._client.post(t4(sv(),r,e),{...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers])})}async createAndPoll(e,t,n){let r=await this.create(e,t);return await this.poll(e,r.id,n)}listFiles(e,t,n){let{vector_store_id:r,...s}=t;return this._client.getAPIList(t4(sw(),r,e),tq,{query:s,...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers])})}async poll(e,t,n){var r,s;let i=nP([null==n?void 0:n.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":null!=(s=null==n||null==(r=n.pollIntervalMs)?void 0:r.toString())?s:void 0}]);for(;;){let{data:r,response:s}=await this.retrieve(t,{vector_store_id:e},{...n,headers:i}).withResponse();switch(r.status){case"in_progress":let o=5e3;if(null==n?void 0:n.pollIntervalMs)o=n.pollIntervalMs;else{let e=s.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(o=t)}}await tn(o);break;case"failed":case"cancelled":case"completed":return r}}}async uploadAndPoll(e,t,n){var r;let{files:s,fileIds:i=[]}=t;if(null==s||0==s.length)throw Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");let o=Math.min(null!=(r=null==n?void 0:n.maxConcurrency)?r:5,s.length),a=this._client,l=s.values(),c=[...i];async function u(e){for(let t of e){let e=await a.files.create({file:t,purpose:"assistants"},n);c.push(e.id)}}let h=Array(o).fill(l).map(u);return await sm(h),await this.createAndPoll(e,{file_ids:c})}}function s_(){let e=t8(["/vector_stores/","/files"]);return s_=function(){return e},e}function sx(){let e=t8(["/vector_stores/","/files/",""]);return sx=function(){return e},e}function sS(){let e=t8(["/vector_stores/","/files/",""]);return sS=function(){return e},e}function sA(){let e=t8(["/vector_stores/","/files"]);return sA=function(){return e},e}function sj(){let e=t8(["/vector_stores/","/files/",""]);return sj=function(){return e},e}function sP(){let e=t8(["/vector_stores/","/files/","/content"]);return sP=function(){return e},e}class sI extends t5{create(e,t,n){return this._client.post(t4(s_(),e),{body:t,...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers])})}retrieve(e,t,n){let{vector_store_id:r}=t;return this._client.get(t4(sx(),r,e),{...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers])})}update(e,t,n){let{vector_store_id:r,...s}=t;return this._client.post(t4(sS(),r,e),{body:s,...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers])})}list(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return this._client.getAPIList(t4(sA(),e),tq,{query:t,...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers])})}delete(e,t,n){let{vector_store_id:r}=t;return this._client.delete(t4(sj(),r,e),{...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers])})}async createAndPoll(e,t,n){let r=await this.create(e,t,n);return await this.poll(e,r.id,n)}async poll(e,t,n){var r,s;let i=nP([null==n?void 0:n.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":null!=(s=null==n||null==(r=n.pollIntervalMs)?void 0:r.toString())?s:void 0}]);for(;;){let r=await this.retrieve(t,{vector_store_id:e},{...n,headers:i}).withResponse(),s=r.data;switch(s.status){case"in_progress":let o=5e3;if(null==n?void 0:n.pollIntervalMs)o=n.pollIntervalMs;else{let e=r.response.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(o=t)}}await tn(o);break;case"failed":case"completed":return s}}}async upload(e,t,n){let r=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:r.id},n)}async uploadAndPoll(e,t,n){let r=await this.upload(e,t,n);return await this.poll(e,r.id,n)}content(e,t,n){let{vector_store_id:r}=t;return this._client.getAPIList(t4(sP(),r,e),tF,{...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers])})}}function sR(){let e=t8(["/vector_stores/",""]);return sR=function(){return e},e}function sE(){let e=t8(["/vector_stores/",""]);return sE=function(){return e},e}function sO(){let e=t8(["/vector_stores/",""]);return sO=function(){return e},e}function sk(){let e=t8(["/vector_stores/","/search"]);return sk=function(){return e},e}class sN extends t5{create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==t?void 0:t.headers])})}retrieve(e,t){return this._client.get(t4(sR(),e),{...t,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==t?void 0:t.headers])})}update(e,t,n){return this._client.post(t4(sE(),e),{body:t,...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers])})}list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return this._client.getAPIList("/vector_stores",tq,{query:e,...t,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==t?void 0:t.headers])})}delete(e,t){return this._client.delete(t4(sO(),e),{...t,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==t?void 0:t.headers])})}search(e,t,n){return this._client.getAPIList(t4(sk(),e),tF,{body:t,method:"post",...n,headers:nP([{"OpenAI-Beta":"assistants=v2"},null==n?void 0:n.headers])})}constructor(){super(...arguments),this.files=new sI(this._client),this.fileBatches=new sb(this._client)}}sN.Files=sI,sN.FileBatches=sb;class sT extends t5{async unwrap(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._client.webhookSecret,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:300;return await this.verifySignature(e,t,n,r),JSON.parse(e)}async verifySignature(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._client.webhookSecret,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:300;if("undefined"==typeof crypto||"function"!=typeof crypto.subtle.importKey||"function"!=typeof crypto.subtle.verify)throw Error("Webhook signature verification is only supported when the `crypto` global is defined");eF(this,eb,"m",e_).call(this,n);let s=nP([t]).values,i=eF(this,eb,"m",ex).call(this,s,"webhook-signature"),o=eF(this,eb,"m",ex).call(this,s,"webhook-timestamp"),a=eF(this,eb,"m",ex).call(this,s,"webhook-id"),l=parseInt(o,10);if(isNaN(l))throw new e6("Invalid webhook timestamp format");let c=Math.floor(Date.now()/1e3);if(c-l>r)throw new e6("Webhook timestamp is too old");if(l>c+r)throw new e6("Webhook timestamp is too new");let u=i.split(" ").map(e=>e.startsWith("v1,")?e.substring(3):e),h=n.startsWith("whsec_")?n$.Buffer.from(n.replace("whsec_",""),"base64"):n$.Buffer.from(n,"utf-8"),d=a?"".concat(a,".").concat(o,".").concat(e):"".concat(o,".").concat(e),f=await crypto.subtle.importKey("raw",h,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(let e of u)try{let t=n$.Buffer.from(e,"base64");if(await crypto.subtle.verify("HMAC",f,t,new TextEncoder().encode(d)))return}catch(e){continue}throw new e6("The given webhook signature does not match the expected signature")}constructor(){super(...arguments),eb.add(this)}}eb=new WeakSet,e_=function(e){if("string"!=typeof e||0===e.length)throw Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},ex=function(e,t){if(!e)throw Error("Headers are required");let n=e.get(t);if(null==n)throw Error("Missing required header: ".concat(t));return n},e.i(30742);class sC{withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders(e){let{values:t,nulls:n}=e}async authHeaders(e){return nP([{Authorization:"Bearer ".concat(this.apiKey)}])}stringifyQuery(e){return function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e,s=function(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tw;if(void 0!==t.allowEmptyArrays&&"boolean"!=typeof t.allowEmptyArrays)throw TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==t.encodeDotInKeys&&"boolean"!=typeof t.encodeDotInKeys)throw TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==t.encoder&&void 0!==t.encoder&&"function"!=typeof t.encoder)throw TypeError("Encoder has to be a function.");let n=t.charset||tw.charset;if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let r=th;if(void 0!==t.format){if(!tp(tf,t.format))throw TypeError("Unknown format option provided.");r=t.format}let s=tf[r],i=tw.filter;if(("function"==typeof t.filter||e7(t.filter))&&(i=t.filter),e=t.arrayFormat&&t.arrayFormat in ty?t.arrayFormat:"indices"in t?t.indices?"indices":"repeat":tw.arrayFormat,"commaRoundTrip"in t&&"boolean"!=typeof t.commaRoundTrip)throw TypeError("`commaRoundTrip` must be a boolean, or absent");let o=void 0===t.allowDots?!0==!!t.encodeDotInKeys||tw.allowDots:!!t.allowDots;return{addQueryPrefix:"boolean"==typeof t.addQueryPrefix?t.addQueryPrefix:tw.addQueryPrefix,allowDots:o,allowEmptyArrays:"boolean"==typeof t.allowEmptyArrays?!!t.allowEmptyArrays:tw.allowEmptyArrays,arrayFormat:e,charset:n,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:tw.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:void 0===t.delimiter?tw.delimiter:t.delimiter,encode:"boolean"==typeof t.encode?t.encode:tw.encode,encodeDotInKeys:"boolean"==typeof t.encodeDotInKeys?t.encodeDotInKeys:tw.encodeDotInKeys,encoder:"function"==typeof t.encoder?t.encoder:tw.encoder,encodeValuesOnly:"boolean"==typeof t.encodeValuesOnly?t.encodeValuesOnly:tw.encodeValuesOnly,filter:i,format:r,formatter:s,serializeDate:"function"==typeof t.serializeDate?t.serializeDate:tw.serializeDate,skipNulls:"boolean"==typeof t.skipNulls?t.skipNulls:tw.skipNulls,sort:"function"==typeof t.sort?t.sort:null,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:tw.strictNullHandling}}(n);"function"==typeof s.filter?r=(0,s.filter)("",r):e7(s.filter)&&(t=s.filter);let i=[];if("object"!=typeof r||null===r)return"";let o=ty[s.arrayFormat],a="comma"===o&&s.commaRoundTrip;t||(t=Object.keys(r)),s.sort&&t.sort(s.sort);let l=new WeakMap;for(let e=0;e<t.length;++e){let n=t[e];s.skipNulls&&null===r[n]||tv(i,function e(t,n,r,s,i,o,a,l,c,u,h,d,f,p,m,g,y,v){var w,b;let _,x=t,S=v,A=0,j=!1;for(;void 0!==(S=S.get(tb))&&!j;){let e=S.get(t);if(A+=1,void 0!==e)if(e===A)throw RangeError("Cyclic object value");else j=!0;void 0===S.get(tb)&&(A=0)}if("function"==typeof u?x=u(n,x):x instanceof Date?x=null==f?void 0:f(x):"comma"===r&&e7(x)&&(x=tg(x,function(e){return e instanceof Date?null==f?void 0:f(e):e})),null===x){if(o)return c&&!g?c(n,tw.encoder,y,"key",p):n;x=""}if("string"==typeof(w=x)||"number"==typeof w||"boolean"==typeof w||"symbol"==typeof w||"bigint"==typeof w||(b=x)&&"object"==typeof b&&b.constructor&&b.constructor.isBuffer&&b.constructor.isBuffer(b)){if(c){let e=g?n:c(n,tw.encoder,y,"key",p);return[(null==m?void 0:m(e))+"="+(null==m?void 0:m(c(x,tw.encoder,y,"value",p)))]}return[(null==m?void 0:m(n))+"="+(null==m?void 0:m(String(x)))]}let P=[];if(void 0===x)return P;if("comma"===r&&e7(x))g&&c&&(x=tg(x,c)),_=[{value:x.length>0?x.join(",")||null:void 0}];else if(e7(u))_=u;else{let e=Object.keys(x);_=h?e.sort(h):e}let I=l?String(n).replace(/\./g,"%2E"):String(n),R=s&&e7(x)&&1===x.length?I+"[]":I;if(i&&e7(x)&&0===x.length)return R+"[]";for(let n=0;n<_.length;++n){let w=_[n],b="object"==typeof w&&void 0!==w.value?w.value:x[w];if(a&&null===b)continue;let S=d&&l?w.replace(/\./g,"%2E"):w,j=e7(x)?"function"==typeof r?r(R,S):R:R+(d?"."+S:"["+S+"]");v.set(t,A);let I=new WeakMap;I.set(tb,v),tv(P,e(b,j,r,s,i,o,a,l,"comma"===r&&g&&e7(x)?null:c,u,h,d,f,p,m,g,y,I))}return P}(r[n],n,o,a,s.allowEmptyArrays,s.strictNullHandling,s.skipNulls,s.encodeDotInKeys,s.encode?s.encoder:null,s.filter,s.sort,s.allowDots,s.serializeDate,s.format,s.formatter,s.encodeValuesOnly,s.charset,l))}let c=i.join(s.delimiter),u=!0===s.addQueryPrefix?"?":"";return s.charsetSentinel&&("iso-8859-1"===s.charset?u+="utf8=%26%2310003%3B&":u+="utf8=%E2%9C%93&"),c.length>0?u+c:""}(e,{arrayFormat:"brackets"})}getUserAgent(){return"".concat(this.constructor.name,"/JS ").concat(tr)}defaultIdempotencyKey(){return"stainless-node-retry-".concat(eq())}makeStatusError(e,t,n,r){return ez.generate(e,t,n,r)}async _callApiKey(){let e,t=this._options.apiKey;if("function"!=typeof t)return!1;try{e=await t()}catch(e){if(e instanceof eJ)throw e;throw new eJ("Failed to get token from 'apiKey' function: ".concat(e.message),{cause:e})}if("string"!=typeof e||!e)throw new eJ("Expected 'apiKey' function argument to return a string but it returned ".concat(e));return this.apiKey=e,!0}buildURL(e,t,n){let r=!eF(this,eS,"m",eP).call(this)&&n||this.baseURL,s=new URL(e4.test(e)?e:r+(r.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),i=this.defaultQuery();return!function(e){if(!e)return!0;for(let t in e)return!1;return!0}(i)&&(t={...i,...t}),"object"==typeof t&&t&&!Array.isArray(t)&&(s.search=this.stringifyQuery(t)),s.toString()}async prepareOptions(e){await this._callApiKey()}async prepareRequest(e,t){let{url:n,options:r}=t}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(n=>({method:e,path:t,...n})))}request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new tU(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,n){var r,s,i;let o=await e,a=null!=(s=o.maxRetries)?s:this.maxRetries;null==t&&(t=a),await this.prepareOptions(o);let{req:l,url:c,timeout:u}=await this.buildRequest(o,{retryCount:a-t});await this.prepareRequest(l,{url:c,options:o});let h="log_"+(0x1000000*Math.random()|0).toString(16).padStart(6,"0"),d=void 0===n?"":", retryOf: ".concat(n),f=Date.now();if(tO(this).debug("[".concat(h,"] sending request"),tk({retryOfRequestLogID:n,method:o.method,url:c,options:o,headers:l.headers})),null==(r=o.signal)?void 0:r.aborted)throw new eK;let p=new AbortController,m=await this.fetchWithTimeout(c,l,u,p).catch(eH),g=Date.now();if(m instanceof globalThis.Error){let e="retrying, ".concat(t," attempts remaining");if(null==(i=o.signal)?void 0:i.aborted)throw new eK;let r=eX(m)||/timed? ?out/i.test(String(m)+("cause"in m?String(m.cause):""));if(t)return tO(this).info("[".concat(h,"] connection ").concat(r?"timed out":"failed"," - ").concat(e)),tO(this).debug("[".concat(h,"] connection ").concat(r?"timed out":"failed"," (").concat(e,")"),tk({retryOfRequestLogID:n,url:c,durationMs:g-f,message:m.message})),this.retryRequest(o,t,null!=n?n:h);if(tO(this).info("[".concat(h,"] connection ").concat(r?"timed out":"failed"," - error; no more retries left")),tO(this).debug("[".concat(h,"] connection ").concat(r?"timed out":"failed"," (error; no more retries left)"),tk({retryOfRequestLogID:n,url:c,durationMs:g-f,message:m.message})),r)throw new eY;throw new eV({cause:m})}let y=[...m.headers.entries()].filter(e=>{let[t]=e;return"x-request-id"===t}).map(e=>{let[t,n]=e;return", "+t+": "+JSON.stringify(n)}).join(""),v="[".concat(h).concat(d).concat(y,"] ").concat(l.method," ").concat(c," ").concat(m.ok?"succeeded":"failed"," with status ").concat(m.status," in ").concat(g-f,"ms");if(!m.ok){let e=await this.shouldRetry(m);if(t&&e){let e="retrying, ".concat(t," attempts remaining");return await tc(m.body),tO(this).info("".concat(v," - ").concat(e)),tO(this).debug("[".concat(h,"] response error (").concat(e,")"),tk({retryOfRequestLogID:n,url:m.url,status:m.status,headers:m.headers,durationMs:g-f})),this.retryRequest(o,t,null!=n?n:h,m.headers)}let r=e?"error; no more retries left":"error; not retryable";tO(this).info("".concat(v," - ").concat(r));let s=await m.text().catch(e=>eH(e).message),i=(e=>{try{return JSON.parse(e)}catch(e){return}})(s),a=i?void 0:s;throw tO(this).debug("[".concat(h,"] response error (").concat(r,")"),tk({retryOfRequestLogID:n,url:m.url,status:m.status,headers:m.headers,message:a,durationMs:Date.now()-f})),this.makeStatusError(m.status,i,a,m.headers)}return tO(this).info(v),tO(this).debug("[".concat(h,"] response start"),tk({retryOfRequestLogID:n,url:m.url,status:m.status,headers:m.headers,durationMs:g-f})),{response:m,options:o,controller:p,requestLogID:h,retryOfRequestLogID:n,startTime:f}}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}requestAPIList(e,t){return new tW(this,this.makeRequest(t,null,void 0),e)}async fetchWithTimeout(e,t,n,r){let{signal:s,method:i,...o}=t||{};s&&s.addEventListener("abort",()=>r.abort());let a=setTimeout(()=>r.abort(),n),l=globalThis.ReadableStream&&o.body instanceof globalThis.ReadableStream||"object"==typeof o.body&&null!==o.body&&Symbol.asyncIterator in o.body,c={signal:r.signal,...l?{duplex:"half"}:{},method:"GET",...o};i&&(c.method=i.toUpperCase());try{return await this.fetch.call(void 0,e,c)}finally{clearTimeout(a)}}async shouldRetry(e){let t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||409===e.status||429===e.status||!!(e.status>=500))}async retryRequest(e,t,n,r){let s,i=null==r?void 0:r.get("retry-after-ms");if(i){let e=parseFloat(i);Number.isNaN(e)||(s=e)}let o=null==r?void 0:r.get("retry-after");if(o&&!s){let e=parseFloat(o);s=Number.isNaN(e)?Date.parse(o)-Date.now():1e3*e}if(!(s&&0<=s&&s<6e4)){var a;let n=null!=(a=e.maxRetries)?a:this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(t,n)}return await tn(s),this.makeRequest(e,t-1,n)}calculateDefaultRetryTimeoutMillis(e,t){return Math.min(.5*Math.pow(2,t-e),8)*(1-.25*Math.random())*1e3}async buildRequest(e){var t,n,r;let{retryCount:s=0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i={...e},{method:o,path:a,query:l,defaultBaseURL:c}=i,u=this.buildURL(a,l,c);"timeout"in i&&((e,t)=>{if("number"!=typeof t||!Number.isInteger(t))throw new eJ("".concat(e," must be an integer"));if(t<0)throw new eJ("".concat(e," must be a positive integer"))})("timeout",i.timeout),i.timeout=null!=(t=i.timeout)?t:this.timeout;let{bodyHeaders:h,body:d}=this.buildBody({options:i}),f=await this.buildHeaders({options:e,method:o,bodyHeaders:h,retryCount:s});return{req:{method:o,headers:f,...i.signal&&{signal:i.signal},...globalThis.ReadableStream&&d instanceof globalThis.ReadableStream&&{duplex:"half"},...d&&{body:d},...null!=(n=this.fetchOptions)?n:{},...null!=(r=i.fetchOptions)?r:{}},url:u,timeout:i.timeout}}async buildHeaders(e){let{options:n,method:r,bodyHeaders:s,retryCount:i}=e,o={};this.idempotencyHeader&&"get"!==r&&(n.idempotencyKey||(n.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=n.idempotencyKey);let a=nP([o,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(i),...n.timeout?{"X-Stainless-Timeout":String(Math.trunc(n.timeout/1e3))}:{},...null!=t?t:t=(()=>{var e,t,n,r,s;let i="undefined"!=typeof Deno&&null!=Deno.build?"deno":"undefined"!=typeof EdgeRuntime?"edge":"[object process]"===Object.prototype.toString.call(void 0!==globalThis.process?globalThis.process:0)?"node":"unknown";if("deno"===i)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":tr,"X-Stainless-OS":ti(Deno.build.os),"X-Stainless-Arch":ts(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:null!=(t=null==(e=Deno.version)?void 0:e.deno)?t:"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":tr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"other:".concat(EdgeRuntime),"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if("node"===i)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":tr,"X-Stainless-OS":ti(null!=(n=globalThis.process.platform)?n:"unknown"),"X-Stainless-Arch":ts(null!=(r=globalThis.process.arch)?r:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":null!=(s=globalThis.process.version)?s:"unknown"};let o=function(){if("undefined"==typeof navigator||!navigator)return null;for(let{key:e,pattern:t}of[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}]){let n=t.exec(navigator.userAgent);if(n){let t=n[1]||0,r=n[2]||0,s=n[3]||0;return{browser:e,version:"".concat(t,".").concat(r,".").concat(s)}}}return null}();return o?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":tr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"browser:".concat(o.browser),"X-Stainless-Runtime-Version":o.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":tr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}})(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(n),this._options.defaultHeaders,s,n.headers]);return this.validateHeaders(a),a.values}buildBody(e){let{options:{body:t,headers:n}}=e;if(!t)return{bodyHeaders:void 0,body:void 0};let r=nP([n]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||"string"==typeof t&&r.values.has("content-type")||globalThis.Blob&&t instanceof globalThis.Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:"object"==typeof t&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&"function"==typeof t.next)?{bodyHeaders:void 0,body:ta(t)}:eF(this,ej,"f").call(this,{body:t,headers:r})}constructor({baseURL:e=nG("OPENAI_BASE_URL"),apiKey:t=nG("OPENAI_API_KEY"),organization:n=null!=(eI=nG("OPENAI_ORG_ID"))?eI:null,project:r=null!=(eR=nG("OPENAI_PROJECT_ID"))?eR:null,webhookSecret:s=null!=(eE=nG("OPENAI_WEBHOOK_SECRET"))?eE:null,...i}={}){var o,a,l,c,u,h;if(eS.add(this),ej.set(this,void 0),this.completions=new rt(this),this.chat=new nA(this),this.embeddings=new r_(this),this.files=new rU(this),this.images=new r8(this),this.audio=new nO(this),this.moderations=new r7(this),this.models=new r4(this),this.fineTuning=new r1(this),this.graders=new r5(this),this.vectorStores=new sN(this),this.webhooks=new sT(this),this.beta=new re(this),this.batches=new nT(this),this.uploads=new sp(this),this.responses=new sc(this),this.realtime=new se(this),this.conversations=new rb(this),this.evals=new rC(this),this.containers=new rh(this),void 0===t)throw new eJ("Missing credentials. Please pass an `apiKey`, or set the `OPENAI_API_KEY` environment variable.");let d={apiKey:t,organization:n,project:r,webhookSecret:s,...i,baseURL:e||"https://api.openai.com/v1"};if(!d.dangerouslyAllowBrowser&&"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator)throw new eJ("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");this.baseURL=d.baseURL,this.timeout=null!=(o=d.timeout)?o:eA.DEFAULT_TIMEOUT,this.logger=null!=(a=d.logger)?a:console;let f="warn";this.logLevel=f,this.logLevel=null!=(c=null!=(l=tj(d.logLevel,"ClientOptions.logLevel",this))?l:tj(nG("OPENAI_LOG"),"process.env['OPENAI_LOG']",this))?c:f,this.fetchOptions=d.fetchOptions,this.maxRetries=null!=(u=d.maxRetries)?u:2,this.fetch=null!=(h=d.fetch)?h:function(){if("undefined"!=typeof fetch)return fetch;throw Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}(),eW(this,ej,tu,"f"),this._options=d,this.apiKey="string"==typeof t?t:"Missing Key",this.organization=n,this.project=r,this.webhookSecret=s}}eA=sC,ej=new WeakMap,eS=new WeakSet,eP=function(){return"https://api.openai.com/v1"!==this.baseURL},sC.OpenAI=eA,sC.DEFAULT_TIMEOUT=6e5,sC.OpenAIError=eJ,sC.APIError=ez,sC.APIConnectionError=eV,sC.APIConnectionTimeoutError=eY,sC.APIUserAbortError=eK,sC.NotFoundError=eZ,sC.ConflictError=e0,sC.RateLimitError=e2,sC.BadRequestError=e$,sC.AuthenticationError=eG,sC.InternalServerError=e5,sC.PermissionDeniedError=eQ,sC.UnprocessableEntityError=e1,sC.InvalidWebhookSignatureError=e6,sC.toFile=t1,sC.Completions=rt,sC.Chat=nA,sC.Embeddings=r_,sC.Files=rU,sC.Images=r8,sC.Audio=nO,sC.Moderations=r7,sC.Models=r4,sC.FineTuning=r1,sC.Graders=r5,sC.VectorStores=sN,sC.Webhooks=sT,sC.Beta=re,sC.Batches=nT,sC.Uploads=sp,sC.Responses=sc,sC.Realtime=se,sC.Conversations=rb,sC.Evals=rC,sC.Containers=rh;let sB=new sC({apiKey:eD.default.env.NEXT_PUBLIC_OPENAI_API_KEY||"",dangerouslyAllowBrowser:!0}),sM=new class{async analyzeTrendingPlayers(e,t){try{let n=this.identifyTrendingPlayers(e),r=[];for(let e of n.slice(0,10)){let n=await this.predictPlayerValue(e,t);r.push(n)}return r.sort((e,t)=>{let n={"must-add":5,high:4,medium:3,low:2,avoid:1},r=n[e.pickupPriority],s=n[t.pickupPriority];return r!==s?s-r:t.confidenceScore-e.confidenceScore})}catch(e){return console.error("Error analyzing trending players:",e),[]}}identifyTrendingPlayers(e){return e.filter(e=>{var t;let n=["QB","RB","WR","TE"].includes(e.position),r=(null==(t=e.stats)?void 0:t.fantasyPoints)||0;return n&&r>0}).sort((e,t)=>{var n,r;let s=(null==(n=e.stats)?void 0:n.fantasyPoints)||0;return((null==(r=t.stats)?void 0:r.fantasyPoints)||0)-s})}async predictPlayerValue(e,t){try{let n=this.buildPredictionPrompt(e,t),r=(await sB.chat.completions.create({model:"gpt-4-turbo-preview",messages:[{role:"system",content:"You are an expert fantasy football analyst specializing in waiver wire predictions. \n                     Analyze players based on recent performance, opportunity, matchups, and team situations.\n                     Provide actionable insights for fantasy managers."},{role:"user",content:n}],temperature:.3,max_tokens:800})).choices[0].message.content||"";return this.parsePredictionResponse(e,r,t)}catch(t){return console.error("Error getting AI prediction:",t),this.getDefaultPrediction(e)}}buildPredictionPrompt(e,t){var n,r,s;return"Analyze this player for waiver wire pickup in a ".concat(t.leagueSize,"-team ").concat(t.scoringType," league:\n\nPlayer: ").concat(e.name,"\nPosition: ").concat(e.position,"\nTeam: ").concat(e.team,"\nRecent Points: ").concat((null==(n=e.stats)?void 0:n.fantasyPoints)||0,"\nProjected Points: ").concat((null==(r=e.stats)?void 0:r.projectedPoints)||0,"\nStatus: ").concat((null==(s=e.status)?void 0:s.gameStatus)||"healthy","\n\nRoster Needs: ").concat(t.rosterNeeds.join(", "),"\nPlayoff Bound: ").concat(t.playoffBound?"Yes":"No","\nMatch Importance: ").concat(t.weeklyMatchupImportance,"\n").concat(t.faabBudgetRemaining?"FAAB Remaining: $".concat(t.faabBudgetRemaining):"","\n\nProvide:\n1. Pickup priority (must-add/high/medium/low/avoid)\n2. Confidence score (0-100)\n3. 3-4 key reasons for the recommendation\n4. Season-long outlook\n5. FAAB bid recommendation (if applicable)\n6. Similar players for comparison\n\nFormat as JSON.")}parsePredictionResponse(e,t,n){try{var r;let n=JSON.parse(t);return{player:e,pickupPriority:n.priority||"medium",confidenceScore:n.confidence||50,projectedValue:n.projectedValue||(null==(r=e.stats)?void 0:r.projectedPoints)||0,reasoning:n.reasoning||["Recent performance trending upward"],relatedNews:n.news||[],seasonProjection:{remainingGames:n.remainingGames||13,projectedPointsPerGame:n.ppg||10,totalProjectedPoints:n.totalPoints||130,playoffScheduleStrength:n.playoffSOS||5},competitiveAnalysis:{percentOwned:n.percentOwned||15,percentStarted:n.percentStarted||5,waiverClaimProjection:n.faabBid||10,expectedCompetition:n.competition||"medium"},comparisonPlayers:n.comparisons||[]}}catch(t){return this.getDefaultPrediction(e)}}getDefaultPrediction(e){var t,n;let r=(null==(t=e.stats)?void 0:t.fantasyPoints)||0,s=(null==(n=e.stats)?void 0:n.projectedPoints)||0,i="medium",o=50;return r>20?(i="high",o=70):r>15?(i="medium",o=60):r<5&&(i="low",o=30),{player:e,pickupPriority:i,confidenceScore:o,projectedValue:s||.8*r,reasoning:["Recent ".concat(r," point performance"),"".concat(e.position," with potential upside"),"Available in most leagues"],relatedNews:[],seasonProjection:{remainingGames:13,projectedPointsPerGame:.8*r,totalProjectedPoints:.8*r*13,playoffScheduleStrength:5},competitiveAnalysis:{percentOwned:20,percentStarted:10,waiverClaimProjection:Math.min(15,Math.floor(r/2)),expectedCompetition:r>15?"high":"medium"},comparisonPlayers:[]}}async findBreakoutCandidates(e,t){return e.filter(e=>{var n;let r=t.some(t=>t.toLowerCase().includes(e.name.toLowerCase())||t.toLowerCase().includes(e.team.toLowerCase())),s=(null==(n=e.stats)?void 0:n.fantasyPoints)&&e.stats.fantasyPoints<10,i=["RB","WR"].includes(e.position);return r||s&&i}).slice(0,5)}calculateFAABBid(e,t){var n;let r=t.faabBudgetRemaining||100;null==(n=e.player.stats)||n.week;let s=r*({"must-add":.4,high:.25,medium:.15,low:.05,avoid:0})[e.pickupPriority];return Math.min(Math.floor(s*(e.confidenceScore/100)*("must-win"===t.weeklyMatchupImportance?1.5:1)),r)}};var sL=e.i(25652),sU=e.i(35408),sD=e.i(78894),sW=e.i(39312),sF=e.i(55711),sq=e.i(12426),sX=e.i(64030),sH=e.i(20278),sJ=e.i(21218),sz=e.i(75254);let sK=(0,sz.default)("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),sV=(0,sz.default)("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);var sY=e.i(31278),s$=e.i(52571),sG=e.i(47163);let sQ=[{id:"ww1",name:"Jaylen Warren",position:"RB",team:"PIT",jerseyNumber:30,status:{isActive:!1,gameStatus:"healthy",lastUpdated:new Date},stats:{season:2024,week:10,fantasyPoints:14.7,projectedPoints:11,rushingYards:74,rushingTDs:1,receptions:4,receivingYards:29}},{id:"ww2",name:"Tyjae Spears",position:"RB",team:"TEN",jerseyNumber:2,status:{isActive:!1,gameStatus:"healthy",lastUpdated:new Date},stats:{season:2024,week:10,fantasyPoints:16.3,projectedPoints:12.5,rushingYards:65,receptions:5,receivingYards:48,receivingTDs:1}},{id:"ww3",name:"Wan'Dale Robinson",position:"WR",team:"NYG",jerseyNumber:17,status:{isActive:!1,gameStatus:"healthy",lastUpdated:new Date},stats:{season:2024,week:10,fantasyPoints:13.8,projectedPoints:10.5,receptions:8,receivingYards:78,targets:11}},{id:"ww4",name:"Luke Musgrave",position:"TE",team:"GB",jerseyNumber:88,status:{isActive:!1,gameStatus:"healthy",lastUpdated:new Date},stats:{season:2024,week:10,fantasyPoints:11.2,projectedPoints:8.5,receptions:5,receivingYards:62,receivingTDs:1}}],sZ={"must-add":"bg-red-500 text-white",high:"bg-orange-500 text-white",medium:"bg-yellow-500 text-white",low:"bg-blue-500 text-white",avoid:"bg-gray-500 text-white"},s0={"must-add":(0,eO.jsx)(sW.Zap,{className:"h-4 w-4"}),high:(0,eO.jsx)(sL.TrendingUp,{className:"h-4 w-4"}),medium:(0,eO.jsx)(sJ.Activity,{className:"h-4 w-4"}),low:(0,eO.jsx)(sU.TrendingDown,{className:"h-4 w-4"}),avoid:(0,eO.jsx)(sD.AlertTriangle,{className:"h-4 w-4"})};function s1(){var e;let{currentTeam:t}=(0,eU.useTeamStore)(),[n,r]=(0,ek.useState)([]),[s,i]=(0,ek.useState)(!1),[o,a]=(0,ek.useState)("all"),[l,c]=(0,ek.useState)(100);(0,ek.useEffect)(()=>{u()},[]);let u=async()=>{var e,n;i(!0);let s={leagueSize:(null==t?void 0:t.leagueSize)||12,scoringType:(null==t?void 0:t.scoringType)||"PPR",rosterNeeds:["RB","WR"],faabBudgetRemaining:l,waiverPriority:3,playoffBound:((null==t||null==(e=t.record)?void 0:e.wins)||0)>((null==t||null==(n=t.record)?void 0:n.losses)||0),weeklyMatchupImportance:"important"};try{await sM.analyzeTrendingPlayers(sQ,s);let e=sQ.map((e,t)=>{var n,r,s,i,o;return{player:e,pickupPriority:0===t?"must-add":1===t?"high":2===t?"medium":"low",confidenceScore:90-15*t,projectedValue:(null==(n=e.stats)?void 0:n.projectedPoints)||10,reasoning:["Strong recent performance with ".concat(null==(s=e.stats)||null==(r=s.fantasyPoints)?void 0:r.toFixed(1)," points"),"Increasing opportunity in ".concat(e.team," offense"),"Favorable upcoming matchups","Low ownership percentage across leagues"].slice(0,3),relatedNews:["".concat(e.name," seeing increased snap count"),"Coach confirms expanded role moving forward"],seasonProjection:{remainingGames:7,projectedPointsPerGame:.85*((null==(i=e.stats)?void 0:i.fantasyPoints)||10),totalProjectedPoints:.85*((null==(o=e.stats)?void 0:o.fantasyPoints)||10)*7,playoffScheduleStrength:6.5},competitiveAnalysis:{percentOwned:25+10*t,percentStarted:10+5*t,waiverClaimProjection:Math.max(5,25-5*t),expectedCompetition:t<2?"high":"medium"},comparisonPlayers:[]}});r(e)}catch(e){console.error("Error analyzing players:",e)}i(!1)},h="all"===o?n:n.filter(e=>e.player.position===o),d=e=>sM.calculateFAABBid(e,{leagueSize:12,scoringType:"PPR",rosterNeeds:["RB","WR"],faabBudgetRemaining:l,playoffBound:!0,weeklyMatchupImportance:"important"});return(0,eO.jsxs)(eO.Fragment,{children:[(0,eO.jsx)(eN.Navigation,{}),(0,eO.jsxs)("main",{className:"container mx-auto p-6",children:[(0,eO.jsxs)("div",{className:"mb-8",children:[(0,eO.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,eO.jsx)(sF.Brain,{className:"h-8 w-8 text-primary"}),(0,eO.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"AI Waiver Wire Predictor"})]}),(0,eO.jsx)("p",{className:"text-muted-foreground",children:"AI-powered analysis to help you dominate the waiver wire"})]}),(0,eO.jsxs)("div",{className:"grid gap-4 md:grid-cols-4 mb-6",children:[(0,eO.jsxs)(eT.Card,{children:[(0,eO.jsxs)(eT.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,eO.jsx)(eT.CardTitle,{className:"text-sm font-medium",children:"FAAB Budget"}),(0,eO.jsx)(sq.DollarSign,{className:"h-4 w-4 text-muted-foreground"})]}),(0,eO.jsxs)(eT.CardContent,{children:[(0,eO.jsxs)("div",{className:"text-2xl font-bold",children:["$",l]}),(0,eO.jsx)(eL.Progress,{value:l/100*100,className:"mt-2"})]})]}),(0,eO.jsxs)(eT.Card,{children:[(0,eO.jsxs)(eT.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,eO.jsx)(eT.CardTitle,{className:"text-sm font-medium",children:"Must-Add Players"}),(0,eO.jsx)(sW.Zap,{className:"h-4 w-4 text-muted-foreground"})]}),(0,eO.jsxs)(eT.CardContent,{children:[(0,eO.jsx)("div",{className:"text-2xl font-bold",children:n.filter(e=>"must-add"===e.pickupPriority).length}),(0,eO.jsx)("p",{className:"text-xs text-muted-foreground",children:"Available this week"})]})]}),(0,eO.jsxs)(eT.Card,{children:[(0,eO.jsxs)(eT.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,eO.jsx)(eT.CardTitle,{className:"text-sm font-medium",children:"Avg Confidence"}),(0,eO.jsx)(sH.Target,{className:"h-4 w-4 text-muted-foreground"})]}),(0,eO.jsxs)(eT.CardContent,{children:[(0,eO.jsxs)("div",{className:"text-2xl font-bold",children:[n.length>0?Math.round(n.reduce((e,t)=>e+t.confidenceScore,0)/n.length):0,"%"]}),(0,eO.jsx)("p",{className:"text-xs text-muted-foreground",children:"AI prediction accuracy"})]})]}),(0,eO.jsxs)(eT.Card,{children:[(0,eO.jsxs)(eT.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,eO.jsx)(eT.CardTitle,{className:"text-sm font-medium",children:"Week"}),(0,eO.jsx)(sX.Trophy,{className:"h-4 w-4 text-muted-foreground"})]}),(0,eO.jsxs)(eT.CardContent,{children:[(0,eO.jsx)("div",{className:"text-2xl font-bold",children:(null==t||null==(e=t.liveScore)?void 0:e.week)||10}),(0,eO.jsx)("p",{className:"text-xs text-muted-foreground",children:"Current NFL week"})]})]})]}),(0,eO.jsx)(eT.Card,{className:"mb-6",children:(0,eO.jsx)(eT.CardContent,{className:"pt-6",children:(0,eO.jsx)(eM.Tabs,{value:o,onValueChange:a,children:(0,eO.jsxs)(eM.TabsList,{className:"grid w-full grid-cols-5",children:[(0,eO.jsxs)(eM.TabsTrigger,{value:"all",children:["All (",n.length,")"]}),(0,eO.jsxs)(eM.TabsTrigger,{value:"QB",children:["QB (",n.filter(e=>"QB"===e.player.position).length,")"]}),(0,eO.jsxs)(eM.TabsTrigger,{value:"RB",children:["RB (",n.filter(e=>"RB"===e.player.position).length,")"]}),(0,eO.jsxs)(eM.TabsTrigger,{value:"WR",children:["WR (",n.filter(e=>"WR"===e.player.position).length,")"]}),(0,eO.jsxs)(eM.TabsTrigger,{value:"TE",children:["TE (",n.filter(e=>"TE"===e.player.position).length,")"]})]})})})}),s?(0,eO.jsx)(eT.Card,{className:"text-center py-16",children:(0,eO.jsxs)(eT.CardContent,{children:[(0,eO.jsx)(sY.Loader2,{className:"h-12 w-12 animate-spin mx-auto mb-4 text-primary"}),(0,eO.jsx)("p",{className:"text-lg font-semibold",children:"Analyzing waiver wire targets..."}),(0,eO.jsx)("p",{className:"text-sm text-muted-foreground",children:"Using AI to evaluate player value"})]})}):(0,eO.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:h.map(e=>{var t,n,r,s;return(0,eO.jsxs)(eT.Card,{className:"hover:shadow-lg transition-shadow",children:[(0,eO.jsx)(eT.CardHeader,{children:(0,eO.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,eO.jsxs)("div",{children:[(0,eO.jsx)(eT.CardTitle,{className:"text-lg",children:e.player.name}),(0,eO.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,eO.jsx)(eB.Badge,{variant:"secondary",children:e.player.position}),(0,eO.jsx)("span",{className:"text-sm text-muted-foreground",children:e.player.team})]})]}),(0,eO.jsxs)(eB.Badge,{className:(0,sG.cn)(sZ[e.pickupPriority],"flex items-center gap-1"),children:[s0[e.pickupPriority],e.pickupPriority.replace("-"," ").toUpperCase()]})]})}),(0,eO.jsxs)(eT.CardContent,{className:"space-y-4",children:[(0,eO.jsxs)("div",{children:[(0,eO.jsxs)("div",{className:"flex items-center justify-between text-sm mb-1",children:[(0,eO.jsx)("span",{className:"text-muted-foreground",children:"AI Confidence"}),(0,eO.jsxs)("span",{className:"font-medium",children:[e.confidenceScore,"%"]})]}),(0,eO.jsx)(eL.Progress,{value:e.confidenceScore,className:"h-2"})]}),(0,eO.jsxs)("div",{className:"flex items-center justify-between",children:[(0,eO.jsx)("span",{className:"text-sm text-muted-foreground",children:"Recent Points"}),(0,eO.jsxs)("div",{className:"flex items-center gap-1",children:[(0,eO.jsx)("span",{className:"font-semibold",children:null==(n=e.player.stats)||null==(t=n.fantasyPoints)?void 0:t.toFixed(1)}),((null==(r=e.player.stats)?void 0:r.fantasyPoints)||0)>((null==(s=e.player.stats)?void 0:s.projectedPoints)||0)?(0,eO.jsx)(sK,{className:"h-3 w-3 text-green-500"}):(0,eO.jsx)(sV,{className:"h-3 w-3 text-red-500"})]})]}),(0,eO.jsxs)("div",{className:"rounded-lg bg-primary/10 p-3",children:[(0,eO.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,eO.jsx)("span",{className:"text-sm font-medium",children:"Recommended Bid"}),(0,eO.jsxs)(eB.Badge,{variant:"outline",className:"font-bold",children:["$",d(e)]})]}),(0,eO.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e.competitiveAnalysis.expectedCompetition," competition expected"]})]}),(0,eO.jsxs)("div",{className:"space-y-2",children:[(0,eO.jsx)("p",{className:"text-sm font-medium",children:"Why Add:"}),e.reasoning.slice(0,2).map((e,t)=>(0,eO.jsxs)("div",{className:"flex items-start gap-2",children:[(0,eO.jsx)(s$.Info,{className:"h-3 w-3 text-primary mt-0.5"}),(0,eO.jsx)("p",{className:"text-xs text-muted-foreground",children:e})]},t))]}),(0,eO.jsx)("div",{className:"border-t pt-3",children:(0,eO.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[(0,eO.jsxs)("div",{children:[(0,eO.jsx)("span",{className:"text-muted-foreground",children:"Rest of Season"}),(0,eO.jsxs)("p",{className:"font-semibold",children:[e.seasonProjection.totalProjectedPoints.toFixed(0)," pts"]})]}),(0,eO.jsxs)("div",{children:[(0,eO.jsx)("span",{className:"text-muted-foreground",children:"Owned %"}),(0,eO.jsxs)("p",{className:"font-semibold",children:[e.competitiveAnalysis.percentOwned,"%"]})]})]})}),(0,eO.jsxs)(eC.Button,{className:"w-full",variant:"must-add"===e.pickupPriority?"default":"outline",children:[(0,eO.jsx)(sq.DollarSign,{className:"mr-2 h-4 w-4"}),"Place $",d(e)," Bid"]})]})]},e.player.id)})}),(0,eO.jsxs)(eT.Card,{className:"mt-8 bg-gradient-to-r from-primary/5 to-purple-500/5",children:[(0,eO.jsx)(eT.CardHeader,{children:(0,eO.jsx)(eT.CardTitle,{children:"How AI Predictions Work"})}),(0,eO.jsxs)(eT.CardContent,{className:"space-y-2",children:[(0,eO.jsxs)("p",{className:"text-sm text-muted-foreground",children:[" ",(0,eO.jsx)("strong",{children:"Machine Learning"})," - Analyzes historical data and player trends"]}),(0,eO.jsxs)("p",{className:"text-sm text-muted-foreground",children:[" ",(0,eO.jsx)("strong",{children:"Opportunity Score"})," - Evaluates touches, targets, and snap counts"]}),(0,eO.jsxs)("p",{className:"text-sm text-muted-foreground",children:[" ",(0,eO.jsx)("strong",{children:"Trend Analysis"})," - Identifies breakout candidates before they explode"]}),(0,eO.jsxs)("p",{className:"text-sm text-muted-foreground",children:[" ",(0,eO.jsx)("strong",{children:"FAAB Optimization"})," - Suggests optimal bid amounts based on competition"]})]})]})]})]})}}]);